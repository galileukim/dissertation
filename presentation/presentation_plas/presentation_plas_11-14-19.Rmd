---
title: "Governing through Patronage"
subtitle: "the Bargain for Education in Decentralized Brazil"
author: "Galileu Kim"
date: "`r Sys.Date()`"
output:
  beamer_presentation:
    includes:
      in_header: "../template/presentation.txt"
    incremental: false
    keep_tex: true
    slide_level: 2
---

```{r setup, include = F}
library(knitr)
library(here)
source(
  here("scripts/thesis_setup.R")
)

source(
  here("presentation/presentation_plas/presentation_data.R")
)

opts_chunk$set(echo = FALSE, size = 10, cache = F, root.dir = here())
```

# Motivation

## A tale of two schools

```{r, out.width = "160px"}
include_graphics(
  here("presentation/presentation_plas/figs/photo_cover_plas_2019.jpg")
)
```

## Expansion in public education

- Across the world, children rely on public education.
- Rapid expansion in coverage over the last decades.
- Improvements in *quality* remain a challenge.

## Net primary enrollment rates

```{r}
plot_enroll <- edu_global %>%
  gg_point(
    aes(
      year,
      enrollment_rate_primary
    )
  ) +
  annotate(
    "text",
    label = "Global average",
    2010, 80
  ) +
  labs(
    y = "Enrollment (percentage)",
    x = "Year"
  ) +
  coord_cartesian(ylim = c(75, 100))

print(plot_enroll)
```

## Net primary enrollment rates

```{r}
plot_enroll +
  geom_point(
    edu_br,
    mapping = aes(
      year,
      enrollment_rate_primary
    ),
    col = "coral3"
  ) +
  annotate(
    "text",
    label = "Brazil",
    2015, 100
  ) 
```

## Quality of education

```{r}
plot_pisa <- edu_global %>% 
  gg_point(
    aes(
      year,
      pisa_reading
    )
  ) +
  annotate(
    "text",
    label = "Global average",
    2012, 490
  ) +
  labs(
    y = "Pisa scores (reading)",
    x = "Year"
  ) +
  coord_cartesian(
    xlim = c(1998, 2017),
    ylim = c(375, 500)
  )

print(plot_pisa)
```

## Quality of education

```{r}
plot_pisa +
  geom_point(
    edu_br,
    mapping = aes(
      year,
      pisa_reading
    ),
    col = "coral3"
  ) +
  annotate(
    "text",
    label = "Brazil",
    2012, 400
  )
```

## A domestic story

```{r, fig.cap="Source: National System for Educational Assessment (SAEB)"}
include_graphics(
  "figs/saeb_map.pdf"
)
```

## Research question

- Why does inequality in the quality of public education persist? Why do some communities have access to better quality education than others?
- How do local actors decide to manage public education? What are the political costs and benefits of improving public education?

## Findings
- Bureaucratic staff turnover has negative consequences for student learning.
- Staff positions granted to members of legislative coalition.
- Political fragmentation leads to greater patronage.
- Electoral accountability does not bite: elite game.

## Outline

\tableofcontents

# The debate

## Public services provision

# The case

## The case: Brazil

- Over 23 million students enrolled in public schools.
- ~12% of GDP spent in education.
- 1.2 million public teachers per year.
- 5.5 thousand municipalities.
- Education is local: municipal governments administer primary education.

## Data

- Student learning.
    - National System of Educational Assessment (SAEB)
    - CearÃ¡ System of Learning Assessment (SPAECE)
- Educational staff.
    - National School Census
    - Annual Report on Social Information (RAIS)
- Additional covariates.
    - National Institute of Geography and Statistics (IBGE)
    - FINBRA
    - TSE

# The argument

## Movement in two steps

- Quality of student learning decreases with educational staff turnover.
- Teacher and school principals are reshuffled as a result of political turnover.
- Jobs are allocated to coalition members, to maintain legislative support.
- An elite game: electoral accountability does not bite.

## Educational staff turnover

```{r}
rais_edu %>% 
  filter(year >= 1995) %>% 
  group_by(
    rais_category,
    year
  ) %>% 
  summarise_prop(
    "rais_hired"
  ) %>% 
  ggplot(
    aes(
      year,
      prop,
      col = rais_category
    )
  ) +
  geom_point() +
  facet_wrap(
    . ~ rais_category,
    labeller = labeller(
      rais_category = c(principal = "Principal", teacher = "Teacher")
    )
  ) +
  mandate_year(
    seq(1997, 2013, 4)
  )
```

## Downstream effects\

```{r models, eval = F}

```

```{r graphs, eval = F}
graphs <- list()

graphs$lm_base <- tidycoef(
  mods$lm_base,
  vars = c("coalition_share|^saeb_principal")
)

graphs$lmer_base <- tidycoef(
  mods$lmer_base,
  vars = c("coalition_share|^saeb_principal")
)

print(graphs$lm_base)
print(graphs$lmer_base)
```

## Alternative explanations

```{r}
plots_alternative <- map(
  c("censo_median_wage", "budget_pc", "sum", "censo_pop"),
  ~gg_hex(
    data = saeb_mun,
    aes_string(
      .,
      "mean_grade_exam_dm"
    ),
    n_bin = 60
  ) +
    xlab("") +
    ylab("") +
    theme(
      legend.position = "none"
    ) +
    scale_x_log10(
      breaks = log_breaks()
    )
)

plots_alternative %<>%
  modify_at(
    c(1,3),
    ~. + 
      labs(y = "test scores")
  )

ggarrange(
  plots = plots_alternative,
  ncol = 2
)
```

## Table of contents

```{r}
saeb_mun %>% 
  gg_hex(
    aes(
      turnover_index,
      mean_grade_exam_dm
    ),
    n_bin = 100
  ) +
  theme(legend.position = "none")
```

# Results

## First stage

## Second stage

# Conclusion
