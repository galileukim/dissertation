--- 
title: "The Executive Dilemma: Bargaining for Education in Decentralized Brazil"
author: "Galileu Kim"
date: "`r Sys.Date()`"
site: bookdown::bookdown_site
output: bookdown::gitbook
documentclass: book
bibliography: [dissertation.bib, packages.bib]
biblio-style: apalike
link-citations: yes
github-repo: dissertation
fontsize: 12pt
geometry: [top=1.5in, bottom=1.5in, right=1.5in, left=1.5in]
header-includes:
  - \setlength\parindent{20pt}
  - \usepackage{setspace}
  - \usepackage{multirow}
  - \usepackage{caption}
  - \usepackage{amsmath}
  - \usepackage{setspace}\doublespacing
  - \usepackage{graphicx}
  - \usepackage{subcaption}
  # - \usepackage{floatrow}
  - \newcommand{\argmax}{arg\,max}
  - \pretitle{\centering\Large\textbf}
  - \preauthor{\centering\large}
  - \predate{\centering\normalsize}
description: "Why do politicians engage in patronage? What are its consequences for public service delivery? I find that staff turnover in educational staff results from mayors attempt to exchange public sector jobs for support from local legislators. Leveraging extensive fieldwork and administrative data, I demonstrate that mayors with a weaker hold on the local legislature resort to patronage to co-opt legislators. Educational staff turnover has negative downstream effects on student learning, but limited electoral backlash. Weak electoral accountability channels suggests that patronage is primarily a political elite game, with little involvement by local constituencies. These findings point to the dangers of elite capture of public services and its downstream consequences for social welfare."
---
```{r include=FALSE, cache=FALSE}
rm(list = ls(all = T))
# set up ------------------------------------------------------------------
pacman::p_load(
  tidyverse,
  data.table,
  rgdal,
  here,
  R.utils,
  GGally,
  lfe,
  lme4,
  plm,
  broom,
  extrafont,
  rprojroot,
  tmap,
  gridExtra,
  cowplot,
  ggdag,
  scales,
  kableExtra,
  RColorBrewer,
  gghighlight,
  parallel,
  foreach,
  gridExtra,
  naniar,
  knitr
)

knitr::opts_chunk$set(
  eval = T,
  cache = T,
  cache.lazy = F,
  message = F,
  warning = F,
  echo = F,
  fig.height = 5,
  fig.width = 8,
  fig.align = "center"
  # dev = "png"
)

source("scripts/thesis_funs.R")

`%<>%` <- magrittr::`%<>%`
between <- data.table::between
set.seed(1789)
```
# Preamble

"We suffer, but those who lose are our students." - anonymous teacher, muncipality of Icó.

```{r include=FALSE}
# automatically create a bib database for R packages
knitr::write_bib(c(
  .packages(), 'bookdown', 'knitr', 'rmarkdown'
), 'packages.bib')
```

<!--chapter:end:index.Rmd-->

```{r include=FALSE, cache=FALSE}
rm(list = ls(all = T))
# set up ------------------------------------------------------------------
pacman::p_load(
  tidyverse,
  data.table,
  rgdal,
  here,
  R.utils,
  GGally,
  lfe,
  lme4,
  plm,
  broom,
  extrafont,
  rprojroot,
  tmap,
  gridExtra,
  cowplot,
  ggdag,
  scales,
  kableExtra,
  RColorBrewer,
  gghighlight,
  parallel,
  foreach,
  gridExtra,
  naniar,
  knitr
)

knitr::opts_chunk$set(
  eval = T,
  cache = T,
  cache.lazy = F,
  message = F,
  warning = F,
  echo = F,
  fig.height = 5,
  fig.width = 8,
  fig.align = "center"
  # dev = "png"
)

source("scripts/thesis_funs.R")

`%<>%` <- magrittr::`%<>%`
between <- data.table::between
set.seed(1789)
```
# Introduction 

```{r include = F, cache = F}
source(
  here::here("scripts/thesis_setup.R")
)

source(
  here("scripts/thesis_funs.R")
)

source(
  here("scripts/thesis_map.R")
)

import_data(
  here("data/saeb"),
  "saeb_exam_mun"
) %>% 
  assign_data

class_mun <- import_data(
  here("data/censo_escolar"),
  "class_mun"
) %>% 
  map_dfr(identity)
```

In the municipality of Icó, children run through the doors of the public school Araújo de Lima to start their classes. Teachers and school managers describe the difficulties they face to improve the quality of public education. Many of the children attending the school are functionally illiterate, able to only read and write their own names. Basic mathematical operations and reading comprehension are learned by the few. In Brazil, as in many countries across the world, low quality learning in public education is widespread. It is not, however, the only possibility.

Only one hundred miles away, in the municipality of Sobral, children complete their path through public education acquiring a diverse set of skills. Classrooms in Ricardo Motta school echo with the sound of children reciting poetry, walls covered with visual aids to teach them fractions. Many of the students attending Sobral's public schools move on to pursue higher education in the prestigious federal universities in Ceará's state capital, Fortaleza, competing for spots with students from private schools in Fortaleza. In both municipalities, the majority of children are enrolled in public schools. The quality of education they receive is, however, highly unequal.

These contrasting cases illustrate a widespread phenomenon. Across the developing and developed world, vulnerable populations rely on governments for access to basic services such as education. These are in law, universal, and over the past few decades, despite setbacks during neoliberal reforms, now cover a larger share of citizens than ever.^[See @haggard_development_2008, @kaufman_globalization_2001.] Despite wider coverage, inequalities remain. As the cases above illustrate, even when two communities both enjoy access to public education, the quality of these services can differ significantly. Some receive high-quality learning as in Sobral, while others, as in Icó, do not. Why do these local inequalities persist? Why do some communities have access to better public services than others?

## Bargaining for education

This dissertation provides a micro-level theory of political actors and their strategic choices on how to deliver public services. Combining qualitative and quantitative evidence, I analyze how political decisions affect the management of public education in municipalities in Brazil. Figure \ref{fig:dag} provides a visual representation of the causal theory I propose.

```{r, fig.cap="\\label{fig:dag}"}
knitr::include_graphics(
  here("figs/thesis_dag.png")
)
```

In a first stage, I demonstrate that municipal variation in the quality of student learning depends on staffing decisions over street-level bureaucrats such as teachers and school principals. In particular, I find that $x\%$ turnover in teacher staff is associated with a $y\%$ decrease in student test scores. This finding is robust to a set of model specifications, including hierarchical linear models as conventionally deployed in statistical analysis of educational attainment.^[@diprete_multilevel_1994.]

In a second stage, I demonstrate that the electorate does not respond to changes in the quality of education, casting doubt on theoretical expectations in accountability models but in line with more recent experimental research.^[@besley_principal_2006, @boas_electoral_2019.] Through interviews with local actors and further empirical analysis, I show that the electorate does not sanction local mayors for lower performance in education. The converse is also true: politicians are not rewarded for improvements in school performance. If a direct accountability channel through the electorate is in large part broken, an alternative set of actors exert pressure over the mayor to induce changes in educational personnel.

Mayors do not govern alone. Replicating existing government institutions at the national level, each municipality is composed of an executive and legislative branch. City councilors, democratically elected legislative officials, are elected concomitantly with the mayor. Similar to congress members at the national level, city councilors are responsible for keeping the local executive in check and fulfill an important role in holding mayors accountable. Of particular imnportance for the mayor is the approval of the budget for the fiscal year, which requires a majority vote in the legislative chamber. Moreover, city councilors provide important access to electoral resources for mayor bidding for reelection.

A key bargaining chip for mayors are public sector appointments. As made clear in interviews with local actors and confirmed in further statistical analysis, city councilors exchange votes in the legislature for appointments into the bureaucracy. 

These findings dialogue with a growing literature on the service delivery consequencses of bureaucratic management.^[@pepinsky_bureaucracy_2017.] @akhtari_bureaucratic_2017 estimates similar effects on educational outcomes in municipal Brazil, leveraging an RDD design with party turnover. Surveillance technologies and peer effects reduce teacher absenteeism in India, with associated improvement in student learning as demonstrated by @duflo_incentives_2012. Clearly, changing the incentive structure for bureaucratic has downstream implications for the quality of public services delivered.^[@finan_personnel_2015.] These managerial decisions, however, are seldom implemented through randomized controlled trials. Primarily, political actors decide public management.

Decentralization has gradually transferred the management of public services to local politicians.^[@falleti_decentralization_2010.] I theorize mayor's strategic choices, embedded in an electoral accountability framework.^[For seminal works on this tradition, see @ferejohn_incumbent_1983, @barro_control_1973.] In doing so, I also build on the seminal work of @geddes_politicians_1994, who models bureaucratic reform as an executive decision.^[Here, and throughout the dissertation, I refer to the mayor with the female pronoun.] In countries across the world, executive leaders enjoy wide latitude in whom to appoint into and dismiss from bureaucracies.^[In the United States, this practice is often referred to as the Plum Book. In Brazil, mayors can appoint and dismiss bureaucrats, with the notable exception of civil servants who comprise (a rapidly falling) majority of teachers.]

```{r map-test, fig.cap = " Each polygon represents a municipality. Average test scores are calculated through an arithmetic mean of the test scores for all students enrolled in the municipal public education for the 2015 edition of the Prova Brasil, conducted by the National Institute for Education Research (INEP).!"}
map_score <- map_br %>% 
  mutate(
    cod_ibge_6 = as.integer(cod_ibge_6)
  ) %>% 
  left_join(
    saeb_exam_mun %>% 
      filter(
        year == 2015
      ),
    by = c("cod_ibge_6")
  )

map_score <- map_score %>% 
  mutate(
    grade_cuts = cut_interval(mean_grade_exam_wgt, 8)
  )

plot_map(
  map_score,
  fill = "mean_grade_exam_wgt",
  legend_position = "none",
  # title = "Student test scores: municipal average (2015)",
  caption = "Source: National System for Educational Assessment (SAEB)."
) +
  ggsave(
    "~/princeton/grants/plas/figs/map_exam_ce.pdf",
    height = 3,
    width = 3
  )
```

\textit{Measure dispersion of test scores across municipalities vs. across states}

Starting in 1988, Brazil and othe developing countries have delegated responsibility for the provision of public services to 

```{r}
# increase in the share of students enrolled in public schools

```

The map in figure \@ref(fig:map-test) provides a visual representation of the uneven quality of public education received by students attending public schools across Brazil. 

*Discuss how wide the spread is, intra-state variation*

This dissertation asks an overarching question, which I decompose into three interconnected inquiries. Under what conditions do local politicians reshape bureaucratic structures to improve the quality of the administrative staff responsible for public service delivery? To answer this, I proceed through backward induction, looking first at the electoral payoffs of improving public service delivery. Are mayors rewarded for improving public service delivery, when running up for reelection? Second, what consequences do practices associated with personnel management, such as bureaucratic turnover, have over public service delivery? Finally, how does the executive-legislative bargain affect personnel decisions? How does the need to negotiate with legislative actors, exchanging public sector jobs for budgetary support, shape bureaucratic turnover?


This question spurs an ongoing and lively debate. Some scholars highlight the need for strengthening electoral accountability in democratic settings, especially in the developing world.^[See @tsai_accountability_2007, @besley_principled_2006.] The theoretical argument is that if politicians are held accountable to their constituency, public services should improve. The emphasis is electoral, hinging on the incentive structure politicians face to convince voters that they have performed well enough in office to be reelected.^[See @ashworth_electoral_2012 for a summary for the literature.]

Another set of scholars argue that variation in the quality of public service is caused by the uneven spread of state capacity. These brown areas of low state capacity are considered a product of underinvestment in professional bureaucracies, often due to resource constraints.^[See @odonnell_state_1993 for a seminal work.] A lack of infrastructural power, or put simply, the limited reach of the state apparatus in its national territory explain why some communities receive high quality education while others do not. Areas in which the state has persistently 

At a theoretical level, holding politicians accountable should clearly improve quality in public services. However, both observational and experimental evidence has been mixed, casting doubts as to the effectiveness of electorate-centric approaches to improving public services.^[@lieberman_does_2014, @boas_electoral_2019.] Turning away from society and to the state itself, growing interest in improving state capacity has motivated social scientists to analyze how to alter incentive structures to improve bureaucratic performance. The evidence has been generally positive, with experiments conducted in @duflo_incentives_2012 showing dramatic reductions in teacher absenteeism in rural India.

In seeking for evidence to answer this inquiry, I have collected and systematized an exhaustive dataset on all bureaucrats hired by municipal governments in Brazil from the transition to democracy (1988) to 2015. This dataset contains information about managers and street-level bureaucrats, providing us with a radiography of the administrative innards of Brazil's localized state.^[@fukuyama_what_2013.] I have structured an electoral dataset containing all politicians, mayors and city councillors, across all municipalities: this allows me to follow their political trajectories as they reshape bureaucracies through their managerial decisions. Finally, I provide measures (albeit imperfect) of the quality of public services: student test scores and infant mortality rates provide us with estimates of how well public services are operating at the local level.

For scholars analyzing states in the developing world, often performed in a historical institutional framework, data collection and systematic analysis demands a herculean effort. For contemporary analysis of state bureaucracies, the task is similarly daunting.^[@fukuyama_what_2013.] As public services and administration have become increasingly decentralized, states have often failed to provide scholars and policymakers with data to analyze these changes. Brazil is a felicitous exception. With an unparalleled wealth of data, I can provide a radiography tracing each personnel decision made by every elected mayor in Brazil from 2000 to 2016.^[Note that electoral data prior to 2000 is still incomplete and an ongoing effort by the Brazilian electoral court.] Over 5 thousand mayors taking office for each electoral cycle, accompanied by 30 thousand city councillors, and an average of 5 million bureaucrats work in each of these municipalities, and we have data for all of them. 

The time is ripe for a nuanced mapping of the divergent developmental paths of municipal public service delivery. Government provision of public services are the primary bloodline of those citizens born in poverty, and most desperately in need. As I later document, these are also where the worst quality healthcare and education services are provided. Understanding the roots in deficiencies in public service delivery demands theoretically and empirically grounded analysis. Ultimately, the welfare of citizens across the developing world depends on a better understanding of how these public service delivery systems are managed. Over this, the shadow of politics looms large. To confront it, we must shed light on it.

## The debate

In this introductory chapter, I lay out the theoretical debate which this dissertation enages with and contributes to. Due to the relatively large scale of this project, it intersects with multiple bodies of literature, which cannot all be addressed in the bounds of this chapter.^[I address particular bodies of literature in their relevant thematic chapters throughout the dissertation.] I opt to focus, in this introduction, on three main literatures which my theoretical argument speaks directly to. I first provide an analysis and critique of the Weberian model of bureaucracy, pushing for an explicit theorization of political administration in the developing world. The second body of literature focuses on the role of institutional legacies in determining state capacity, where I propose an agency-based theoretical approach to model dynamics of change in bureaucratic institutions.

Finally, I address the ways in which decentralization problematizes previous analyses of state institutions, while opening new avenues for theoretical and empirical inquiry. The Pandora's box of subnational heterogeneity, the "brown areas" as noted by @odonnell_state_1993, are a recent phenomenon. These are the result of political decisions reshaping administrative institutions at the subnational level, and as these responsibilities have been increasingly transferred to local politicians, understanding who they are, what are their strategies and payoffs becomes paramount to explaining variation in the quality of public services at the municipal level. To understand contemporary state capacity in an increasingly decentralized developing world, we must go local.^[@grindle_going_2007.]

## From Weber's shadow to political administration

Traditionally, analysis of public administration and bureaucracies in particular has drawn heavily upon the works of Max Weber.^[@weber_max_2009.] In the early 1980s, with the bringing back of the state and its administrative institutions, political scientists derived important lessons from Weber's description of the bureaucratic organization. Bureaucracies in the *modern* state were impersonal, rule-based, specialized. The state analogy to the capitalist enterprise, the bureaucracy was a calibrated, efficient machine with professionalized servants.^[@weber_max_2009.] Politics was not to mix with administration: administration, above all, was to be kept public.

Adapting this ideal-type to contemporary states, scholars mapped Weber's typology of bureaucracy as signs of a bureaucracy up to the standards of a strong, modern state.^[@skocpol_bringing_1985.] Among these features were an increasingly professionalized public workforce, sometimes conflated with the expansion in the number of civil servants through its territory.^[@mann_autonomous_1984.] One characteristic became especially salient as concerns expanded over political overreach: bureaucratic autonomy. Calls for a bureaucracy separate from political vicissitudes, an administrative apparatus insulated from myopic elected officials, became commonplace, especially in the developing world.^[Ironically, this was the exact opposite of what Weber posited in his description of bureaucracies, which were expected to conform to the mandate of political rulers.]

I will not provide an exhaustive treatment of the subject. Rather, I will focus on its general contours and how this conceptualization has limited political science in theoretically modeling and empirically analyzing public administration. In simple terms, bureaucratic autonomy denotes the protection of bureaucratic institutions from political manipulation by governing officials, be them democratically elected or not.^[@evans_embedded_1995.] It also denotes a certain degree of esprit de corps, an institutional cohesion that is derived from a sense of common purpose and longevity. This cohesion would be difficult to achieve if politicians could interfere with its internal workings every electoral cycle.^[@suleiman_dismantling_2013.]

A conceptual wall was built to separate the ideal-type of a Weberian, autonomous bureaucracy, free from political interference, and a world in which patrimonialism, the private use by politicians of public administration leads to corruption and inefficiency.^[@grindle_jobs_2012.] Other scholars, searching for empirical validation for these claims, provided historical qualitative and quantitative evidence that bureaucratic autonomy caused rapid economic growth and industrialization.^[@kohli_state-directed_2004, @evans_bureaucracy_1999.] These often normative claims on the need for depoliticized administration was contested, leading to heated debates over its merit - principally in the developed world - with the counterpush of New Public Management (NPM) principles and the need for bureaucratic accountability to elected officials.^[@osborne_banishing_1997.]

The debate on the desirability and consequences of bureaucratic autonomy in the developing world is *not* the one which this dissertation seeks to address. It proposes a new one. A systematic exploration of political administration, and the consequences of its various manifestations on the quality of public services. Politicians can and may dismantle bureaucracies, populating them with political loyalists who are unfitted for their positions.^[@suleiman_dismantling_2013.] That is not the only possible scenario. It may very well be the case that politicians can exercise management decisions in the service of improvements in bureaucratic structures, hiring meritocratically and improving the quality of these organizations.^[@grindle_good_2004.]

It is time to destigmatize political decisions over reshaping bureaucracies. Proponents of an autonomous civil service underemphasize the fact that these institutional reforms are the products of decisions made by politicians.^[While @grindle_jobs_2012 emp# References:hasizes the role of technocrats negotiating with politicians, @geddes_politicians_1994 highlights how investments in state capacity is an executive dilemma.] Moreover, we still know surprisingly little about how electoral concerns in particular and accountability more broadly affects piolitical decisions on how to manage bureaucracies.^[@gulzar_politicians_2017.] This dissertation represents an effort towards that direction, aligning itself with a growing literature on the political decisions to restructure bureaucratic structures.^[@raffler_does_2016, @brollo_victor_2017, @colonnelli_patronage_2017.]

Inserting public administrations within a political context necessarily puts them in motion. In the next section, I address the question of agency and structure. Inevitably, placing politicians as central actors reshaping the state's bureaucratic innards dialogues with a large literature on its historical institutional determinants.^[@skocpol_bringing_1985.] In this body of work, state institutions are often assumed to be slow-moving and not particularly amenable to short-term changes.^[See, for instance, the excellent discussion in @centeno_unpacking_2017.] In broad terms, this assessment is correct: it is hard for individual leaders to effect dramatic changes in the state. However, if we refine our analysis to particular branches of the bureaucracy, and in particular municipal bureaucracies, change is clearly the rule, not the exception.

## An agency-based approach to state capacity

Traditional accounts of state capacity, and bureaucratic institutions in particular, have emphasized reproduction and path-dependence over change.^[@pierson_increasing_2000.] These analytical tools provide limited leverage in analyzing different cycles of political administration - which align with electoral terms, as I later demonstrate - yet it is important to address their empirical contributions and theoretical assumptions. This dissertation dialogues with but ultimately parts ways with them. There are good reasons to emphasize and model change over reproduction, especifically in the context of executive actions over bureaucratic structures at the municipal level, which I outline in this section.

Note that agency-based change in state capacity does not imply an ahistorical lens. The institutional legacy of previous administrations is an important factor affecting the next political administration's decision. Once in office, politicians take into account inherited bureaucratic structures when restructuring them. However, these legacies do not exhaust the set of causal variables explaining bureaucratic structures at time $t + 1$. They are but one of the factors that politicians take into consideration in their decision-making, along with other time-varying factors such as legislative control, electoral payoffs to improvements in public service, and the individual characteristics of politicians.^[This has been modelled extensively in American Politics, primarily through the lens of executive-legislative bargaining. See @huber_bureaucratic_2004.]

I provide a review of extant literature on the prevalently historical-institutional analyses of state capacity, with a strong focus in the developing world. From the hapless origins in colonial exploitation, the absence of generalized war to contemporary structurally engendered practices of clientelism, there seems to be little current policymakers and scholars can do to effect positive, short-term change in state capacity.^[@acemoglu_colonial_2001, @engerman_factor_1997, @centeno_blood_1997.] Currently weak states have little to do today and much to blame for their unfortunate past. This leaves policymakers and scholars alike baffled as to how to enact policy reforms that can have a positive effect in public administration, as noted by @grindle_good_2004.

Take, for instance, the rich historical study presented in @centeno_blood_1997. Centeno highlights how a long colonial (and post-independence) history of dependence on commercial relations with external markets, through commodity-based exports, provided weak incentives for Latin American states to penetrate their territory and tax their own citizens. Contra Tilly, Latin American states waged the "wrong" kind of war, civil wars that depleted reserves while failing to provide incentives for the consolidation of state institutions, since these were too weak to effectively mobilize resources in a total war in the first place.^[@tilly_coercion_1992.] Weak domestic fiscal bases and limited penetration of their domestic territories left most of Latin America populated by weak states.

Another body of scholarly work focuses on factor endowments shaping the developmental path of state institutions in Latin America. In their study, @engerman_factor_1997 highlight how Latin American colonies, characterized by favorable conditions for plantation systems, produced highly unequal societies that locked in institutional arrangements that reproduced inequality in human capital, political power and inhibited economic development. In a similar vein, @acemoglu_colonial_2001 argue that high settler mortality discouraged investments in political institutions, in particular property rights to protect citizens from expropriation. Once set in place, these institutions were reproduced over time and explain different developmental paths.

My conceptual framework reinterprets path-dependence. On the one hand, institutional change is a clearly a costly endeavor. Changing inherited institutions requires confronting actors who may benefit from their reproduction.^[@pierson_increasing_2000.] However, rather than assuming that institutional reproduction will simply occur, I model and identify the conditions under which agents decide to modify institutional arrangements or not.^[For an excellent review, see @thelen_historical_1999.] Change is quotidian. To identify it, we must map what is time-varying and time-invariant, the actors which remain in power and the ones which replace them, sheding light on the vicissitudes of political life in a systematic and sequential manner.

To identify these gradual movements, it is necessary to be empirically precise about the object of inquiry. A lack of conceptual and empirical clarity means that broad claims about the "extractive" nature or "unequal" concentration of political power remain aphorisms, without a substantive measure to detect variance or absence thereof.^[@levitsky_variation_2009 stress the need for empirical measures of institutional strength.] Actors need to be well-defined as well. I link mayors and local legislators to the evolution of public services such as education and healthcare, while shedding light on the bureaucratic personnel responsible for bringing these to life. These interlinked actors and their strategic decisions form the basis of my argument.

Understanding and identifying change in state capacity requires defining the scope of analysis for this dissertation. I focus on a particular set of links in the causal chain: the bureaucratic personnel responsible for providing public services. Concretely, I focus on the municipal provision of education as the primary service which local bureaucrats, ranging from cabinet members, general managers, to frontline teachers and nurses are responsible for delivering in their every workday.

This is not a story of public administration alone. I build a theory of political action shaping bureaucratic personnel. While informally taking into account executive decisions to modify bureaucratic institutions, previous accounts rarely explore the full range and drivers of these decisions. In particular, seldom do we find an explicit treatment of the costs and benefits involved in the decision to invest in state capacity, what Geddes (1994) so aptly names the politician's dilemma. I focus on the electoral payoffs of public service provision: do incumbent mayors benefit from improvements in public service delivery? How does personnel management improve or undermine public services?

Leaders do not govern alone. For every elected mayor in Brazil, a set of legislators also take office. This diverse group of political actors interact strategically, and much of the executive-legislative bargain revolves around valuable buckets of jobs associated with cabinet positions, branches of government and municipal programs. A rich literature has emerged exploring the executive-legislative bargain, particularly in the U.S. context, but their application to the developing world context has been more limited.^[@moe_politics_1989, @mccarty_appointments_2004, and for an overview, @cameron_models_2004.] There is much to be gained in translation.

## The argument: a political administration of public services

This section started with a call for a conceptual change: embrace the political calculus embedded in administration and model it explicitly. In other words, move away from the ideal-type of a Weberian, autonomous bureaucracy and focus theoretically and empirically on political administration.^[@evans_embedded_1995.] Where does that leave us concretely? In this section, I present the conceptual building blocks of my argument. As premised, I focus on the decision-making process by political actors in reshaping the bureaucracy. Key among them are mayors, who hold discretion over whom to fire and recruit into the local administration, and city councillors, who exercise power over budgetary approval.

Understanding political decisions necessarily implies taking into account their consequences, in terms of costs and benefits. Agents in my theoretical model are forward-looking, and their payoff is structured sequentially. Here is an example to build intuition. A mayor is elected into office, and hopes to be reelected. In her first year of mandate, she decides how to restructure her educational staff. If the mayor eliminates experienced, educated school staff in exchange for political loyalists with limited experience, the quality of educational services will fall. If voters are aware of and care about educational services, conditional on a decrease in the quality of public services, the chances of the mayor being reelected decreases.

Moreover, mayors do not govern alone. A legislative opposition at the local city council has an interest in removing the executive leader from office. In Brazil, the local legislature has to approve the budget in order to fund public services. This game structure is conducive to a bargaining dynamic where legislators extract valuable public sector jobs to reward loyalists, in exchange for favorable votes for budgetary approval. Mayors have to engage in coalition building through the offer of valuable public sector jobs, in order to coopt enough legislative votes.

The simple example above illuminates the main actors and payoff structure in my theoretical argument. Concretely:

1. A mayor is elected into office and seeks reelection.
2. Voters (potentially) observe and care about the quality of public services, rewarding good performance.
3. Legislators in the city council seek to maximize their share of public sector jobs.

My theory builds on an extensive literature in the electoral accountability literature, modeling public goods provision as an electoral game played between voters who want to induce good behavior and political incumbents bidding for reelection. Expanding on seminal models by @barro_control_1973 and @ferejohn_incumbent_1986, political economists have explored theories incorporating electoral accountability as an incentive for shaping the behavior of elected officials. The crux of the argument relies on the desire for reelection, which motivates politicians to put effort into providing voters to reelect them.^[@coate_form_1995 and @besley_principled_2006 incorporate voters updating Bayesian beliefs about politician types, a feature applied in my model.]

To summarize, a new mayor is elected into office and has the power to restructure the local bureaucracy. To be reelected, she has to convince the electorate that she will provide high quality public services in her second term, and to do so wants to minimize bureaucratic turnover. However, she must also coopt the legislature to approve the local budget by divving up a share of the bureaucratic pie for patronage.^[This aligns closely to previous studies on the use of ministerial positions to gain support from opposition members at the federal level. See @loureiro_politica_1999, @loureiro_radiografia_2014, @lopez_cargos_2018.] The model highlights the tradeoff executive politicians face between investing in state capacity and garnering legislative votes.

Instead of assuming that politicians can set the quality of public goods provision, I model it as the probabilistic outcome of an investment in bureaucratic quality and legislative support. Producing better public goods requires an experienced and professional bureaucracy and legislative support. Reshuffling the bureaucracy is costly due to the loss of professional expertise accumulated by the inherited staff, but this underlying capacity is meaningless if the legislative does not grant its approval. The executive does not always control the legislative chamber once in office, and have to coopt them into supporting their agenda.^[Analogous to the concept of minority presidents in the literature on coalitional presidentialism. See @figueiredo_presidential_2000.]

The mayor's strategy centers around a key part of her political resources: a set of public sector jobs is available to the executive for redistribution. These are a valuable resource for cooptation.^[Mayors enjoy full discretion into how to appoint workers into the public sector and often resort to distributing these jobs to appease members of the legislative.] However, when doing so executive leaders face a dilemma. The mayor can invest in state capacity, retaining expertise and reaping benefits from better public service provision. However, doing so raises the possibility of retaliation by the opposition, who can threaten to oppose budgetary approval. This is the executive's dilemma.^[@geddes_politicians_1994.]


<!--chapter:end:chapters//01-intro.Rmd-->

```{r include=FALSE, cache=FALSE}
rm(list = ls(all = T))
# set up ------------------------------------------------------------------
pacman::p_load(
  tidyverse,
  data.table,
  rgdal,
  here,
  R.utils,
  GGally,
  lfe,
  lme4,
  plm,
  broom,
  extrafont,
  rprojroot,
  tmap,
  gridExtra,
  cowplot,
  ggdag,
  scales,
  kableExtra,
  RColorBrewer,
  gghighlight,
  parallel,
  foreach,
  gridExtra,
  naniar,
  knitr
)

knitr::opts_chunk$set(
  eval = T,
  cache = T,
  cache.lazy = F,
  message = F,
  warning = F,
  echo = F,
  fig.height = 5,
  fig.width = 8,
  fig.align = "center"
  # dev = "png"
)

source("scripts/thesis_funs.R")

`%<>%` <- magrittr::`%<>%`
between <- data.table::between
set.seed(1789)
```
# Model

## Motivation

In Brazil, and increasingly across the developing world, public services are under the political administration of elected officials. In this section, I present a theoretical model that integrates the calculus of these principals regarding how to manage bureaucracies that deliver public services, mapping out the consequences of these decisions to their political survival and voter welfare. It is a sequential game, in which newly-elected mayors assess the electoral benefits of improving public services while taking into account the political arena they must coopt to get the budget approved.

The starting point of the game is the entry of a newly elected mayor into office.^[For clarity, I denote the mayor with a female pronoun, the legislative opposition in plural and the voter with a male pronoun.] In assuming her new role as the executive leader and manager of the local bureaucracy, the mayor knows that government is not an isolated affair. The political turnover in the executive is accompanied by renewal in the local legislature (*câmara de vereadores*). Some of these city councillors have declared themselves allies in the electoral campaign, composing what is broadly referred to as the government (*governo*) bench in the legislature. The remaining councillors are either independent or part of the opposition.

As noted by @couto_governando_1995, and through my qualitative interviews in municipalities of Brazil, a key feature of local politics is the executive-legislative bargaining over public sector jobs. City councillors actively seek to place loyalists within the bureaucracy, while mayors themselves are more hesitant to do so. This is due to a differential accountability between the two actors: while city councillors cater to small constituencies

## Institutional environment

In Brazil, local governments are composed of two branches. One is the executive, headed by the mayor who is elected through a first past the post system. The other, the local legislature, composed of city councillors elected through an open-list proportional representation system. The existence of these two types of political actors, elected through a different set of institutional rules, introduces in itself a divergent set of interests in the political arena. In particular,

## Structure of the game:

In this section, I outline the action space, payoff structure and timing of the game. There are three actors: a mayor $m$, a legislative opposition $o$ and representative median voter $v$. The goal of the executive is to be reelected into office.^[This is a standard assumption in electoral accountability models, see @besley_principled_2006. For a comparative politics perspective, see @geddes_politicians_1994.] The opposition can either approve the  The voter derives utility from public goods, which is produced by the municipal bureaucracy.

To make analysis tractable and concise, I introduce a set of simplifying assumptions. First, I assume that the voter is sincere, meaning that he only considers his utility when deciding whether to reelect the incumbent. This excludes pivotality concerns and strategic voting from his choice set. Mayors are one of two types: a competent politician who effectively delivers high quality public goods, and an average one, who fails to always hit the mark. Note that this is an informational heuristic. I do not claim there are infallibly competent politicians. The intuition is that voters have beliefs about how competent a politician is (and strictly prefer those), forming their opinions by observing the quality of public goods they observe.

The game is played in two periods. Voter $v$ does not observe the amount of patronage handed out by mayor $m$ nor her type, but observes and derives utility from the realization of public good quality $\omega_t$. A central feature in this model is uncertainty in translating bureaucratic quality $\theta$ at time $t$ to public goods provision $\omega$, with high quality public services $\omega_{h}$ produced probabilistically as a function of $s$ and $\theta$. The parameter $\theta$ captures the inverse relation between patronage and state capacity.^[See @kohli_state-directed_2004.] The share of seats held by the opposition, $s$, also adversely affects the probability of high quality goods being provided through the exercise of veto power.

The optimal strategy for the voter is to fire politicians when he believes that the incumbent is not a competent type, after observing the quality of first period public good $\omega_1$. For the mayor, her strategy is pinned down by the share of patronage which maximizes expected utility from holding onto office, conditional on her type and expected benefits from reelection. Mayor $m$ has to offer public sector jobs to coopt the opposition while ensuring that the voter is satisfied enough to reelect her. The executive's dilemma is how to reconcile the incentive for reelection and the pressure imposed by the opposition.

The timing of the game is:

1) Nature draws the politician's type.
2) Politician observes her type and invests in bureaucratic quality $\theta_1$.
4) Nature realizes public good $\omega_1(\theta_1)$.
5) Voter observes $\omega_1$ and casts vote to retain or fire the incumbent.
6) If incumbent is retained, she sets $\theta_2$ and nature draws $\omega_2(\theta_2)$. If incumbent is deposed, a challenger takes office, sets $\theta_2$ and the game ends.

## Bureaucratic quality, veto power, and public goods provision:

I model public goods quality as a random variable $\omega$ with two possible states $\omega \in \{\omega_l, \omega_h\}$, where $\omega_h>\omega_l$. The probability of a high quality public good $\omega_h$ is a function of $\theta$, a parameter denoting the bureaucratic quality, and $s$, the share of seats held by the opposition. Following @centeno_unpacking_2017, to avoid conceptual stretching I separate state capacity from its output. In this theoretical framework, state capacity is measured by analyzing personnel composition.^[See @fukuyama_what_2013, @bersch_state_2017.] Additionally, the opposition can exercise veto power, which increases monotonically with their share of seats in the legislative. Formally:

$$\text{Pr}(\omega=\omega_h) = \frac{1-s\theta}{1+e^{-(10\theta-5)}}$$
The impact of patronage depends on the share of seats controlled by the opposition. When the opposition have no veto power, i.e. $s=0$, the executive can costlessly improve the quality of the bureaucracy $\theta$, keeping patronage at a minimum and maximizing the probability of high quality public goods. When the opposition controls a larger share of the legislative chamber, it can effectively block the mayor from enacting her policy agenda, unless given a large share of public sector jobs, thus decreasing $\theta$. This is captured by the term $s\theta$ in the expression above.

## The mayor:

The mayor's choice set is the bureaucratic quality parameter $\theta_t$. As $\theta$ increases - the mayor allocates a smaller proportion of jobs for patronage - the legislative opposition decreases their support for the executive and threatens to exercise veto power. This reduces the likelihood of providing the necessary resources to provide public goods. Adapting @gailmard_slackers_2007, there are two types of mayors: competent and average. Competent politicians excel in delivering high quality public goods and are rewarded by voters with reelection. Politicians who fail to excel in such provision are average.

The probability of a politician being competent is common knowledge: $\xi \in [0,1]$. Conversely, the probability of her being average is simply $1 - \xi$. Both types derive utility from public goods provision $\omega$, where for simplicity $u(\omega_l)=0$ and $u(\omega_h) = 1$. We do not model the decision of the competent mayor: she simply delivers high quality goods and is inevitably reelected. We focus on the interesting case of the normal politician.

\begin{align*}
Eu_m \left(\theta_t, s_1 \middle|\lambda \right) &= \textbf{E}(\omega_1) + \delta \text{Pr}(\text{reelection})\left[\psi + \textbf{E}(\omega_2)  \right] \\
&= \frac{1-s_1\theta_1}{1+e^{-(10\theta_1-5)}} + \delta \text{Pr}(\text{reelection})\left[\psi + \frac{1-s_2\theta_2}{1+e^{-(10\theta_2-5)}} \right] \\
\end{align*}

The expression above formalizes the mayor's dilemma. The probability of reelection decreases with the share of jobs allocated to the opposition, since it lowers the quality of the bureaucracy. but if the mayor fails to appease them through patronage, it is increasingly costly to "govern". While technocrats are immune to these political pressures, pragmatists ultimately cave in. The price of compromise in a democratic setting is a reduction in state capacity, as executives are forced to allocate positions within the bureaucracy to garner support in the legislative.^[For a discussion of patronage in Brazilian politics, see @nunes_gramatica_1997. For a historical perspective, @graham_patronage_1994.]

## Solving the dilemma (compromise):

Mayors solve the the game through backward induction. If the mayor is a technocrat, she simply and effectively delivers, and the voter consumes $\omega_h$. The average politician myopically maximizes expected utility in the second period.

\begin{align*}
\frac{\partial Eu_{m}(\theta_1, \theta_2|\lambda = 1, s_2)}{\partial \theta_2} &= 0 \\
\frac{\partial}{\partial \theta_2} \frac{1-s_2\theta_2}{1+e^{-(10\theta_2-5)}} &= 0 \\
\frac{1}{e^{-(10\theta_2^*-5)}}+10\theta_2^* &= \frac{10}{s_2} - 1\\
\theta_2^* &= \frac{1}{10s_1}\left[10-s_2-\boldsymbol{W}\left(e^{\frac{1}{s_2}-6}\right)\right]
\end{align*}

The interpretation of this result is straightforward: increases in the legislative share of the opposition reduces incentives to invest in bureaucratic quality.^[Note that for $s=0$, this expression is undefined. Also, $\boldsymbol{W}$ denotes the Lambert W function.] We can visualize how the optimal bureaucratic quality in the second period changes as a function of $s_2$ by plotting changes in the probability of high quality public goods.

```{r visualization}
library(ggplot2)
fun_1 <- function(x){ (1-x)/(1+exp(-(10*x - 5)))}
fun_2 <- function(x){ (1-0.5*x)/(1+exp(-(10*x - 5)))}
fun_3 <- function(x){ (1)/(1+exp(-(10*x - 5)))}

ggplot(data.frame(x = c(0, 1)), aes(x)) +
  stat_function(
    fun = fun_1
  ) +
  stat_function(
    fun = fun_2
  ) +
  stat_function(
    fun = fun_3
  ) +
  annotate(
    geom = "text",
    x = 0.6,
    y = 0.34,
    label = "s = 1"
  ) +
  annotate(
    geom = "text",
    x = 0.75,
    y = 0.62,
    label = "s = 0.5"
  ) +
  annotate(
    geom = "text",
    x = 0.70,
    y = 0.95,
    label = "s = 0"
  ) +
  xlab("Bureaucratic Quality") +
  ylab("Probability") +
  ggtitle(
    "Impact of opposition legislative share on public goods provision"
  )
```

The quality of the bureaucracy $\theta_2$ which maximizes the mayor's expected utility in the second period is strictly decreasing in $s_2$, the share of seats controlled by the opposition. As the power of the opposition increases, its ability to veto and punish the mayor for withholding from patronage increases. The greater the threat of veto power, the more concessions politicians need to make in order to deliver high quality public goods $\omega_h$. Conversely, when the mayor controls the legislative chamber, the benefits of bureaucratic quality are fully internalized and it is in turn maximized. We now turn to the electoral problem faced by the voters.

<!-- ## Opposition's problem: -->

<!-- The opposition decides whether or not to support the mayor's policies, where $a_o=\left\{ 0,1 \right\}$. If the opposition supports the executive, they receive an $\alpha \in [0,1]$ proportion of public sector jobs, a continuum normalized to 1. The concept of a public sector pie stems from interviews with former and current executive secretaries, who describe a "quota" of jobs allocated to the legislative.^[This echoes the concept of islands of excellence described by @geddes_politicians_1994: small pockets of bureaucratic insulation reserved by the executive for core functions such as macroeconomic management. A similar argument is made in @loureiro_burocracia_2010.] If she refuses, the mayor allocates no pork. I apply the Rubinstein bargaining model solution concept (perfect equilibrium) to solve this subgame with minor adaptations.^[@rubinstein_perfect_1982.] -->

<!-- Mayor's and opposition's utilities are identical to the original setup with two players. I conceptualize the bargain over public sectors as a sequence of offers and counter-offers made by the mayor and her legislative opposition. Following @rubinstein_perfect_1982, players differ in $\delta_i$, a parameter capturing their impatience across sequences in the bargaining game. Respectively: -->

<!-- $$u_m = \prod^{T}_{t=1}\delta_m^t\theta_{1|2}$$  -->
<!-- $$u_o = \prod^{T}_{t=1}\delta_i^t\theta_{1|2}$$ -->


<!-- Applying stationarity restrictions and solving for the unique subgame perfect equilibrium, we have: -->


## State capacity and democratic accountability:

Let $v$ denote the median voter in the municipal electorate. Voters derive utility from the quality of public goods at time $t$, with a discount factor $\delta$.

$$u_v(\omega_t) = \omega_1 + \delta \omega_2$$

Because voters cannot observe directly the type of the politician nor her hiring decisions, voters update beliefs about the politician's type after observing first period public goods output. If a voter observes a low public goods quality, he knows with certainty that the incumbent is incompetent, and therefore $\Pr(\text{competent}|\omega_{1l}) = 0$. Let $\mu(\omega_1)$ denote voter's belief that the politician is of a competent type after observing the first period realization of public goods.

$$\mu(\omega_h) = \text{Pr}(\text{competent}| \omega_h) = \frac{\xi}{\xi + \text{Pr}(\omega_1|s)(1-\xi)}>\xi$$ 

Note that for any $\omega_h$, the probability that the incumbent is competent is higher than the probability of a random challenger being so. As a result, whenever the voter observes a high quality output in the first period, the incumbent gets reelected. This simplifies our analysis. After observing the realization of public good quality $\omega_1$, he retains the incumbent if and only if $\omega_1 = \omega_h$, and fires her otherwise. The probability of re-election is simply the probability that public goods provided are of high quality. This is conditional on $\theta_1$, the amount of investment in state capacity in the first period and $s_1$, the opposition share in the first period.^[Note that the quality of the second period bureaucracy is independent of that in the first period. This is a strong restriction that I will relax in future iterations of this project.]

## Initial investments in state capacity:

We turn to the initial decision of the politician. The executive maximizes her expected utility with respect to first term hiring decisions, factoring in the optimal decision and payoff for the second period. To reiterate, the probability of reelection is simply the probability of high quality public goods provision in the first period. Taking the first order condition with respect to $\theta_1$:

\begin{align*}
\argmax_{\theta_1} \frac{1-s_1\theta_1}{1+e^{-(10\theta_1-5)}}\left[1+\delta\left(\psi + \frac{1-s_2\theta_2^*}{1+e^{-(10\theta_2^*-5)}}\right)\right] &= 0 \\
\end{align*}

The optimal amount of investment in state capacity in the first term is analogous to the myopic optimization in the second period, weighed by the expected payoff of reelection. The intuition behind this result is straightforward. As politicians value the future term more, they will invest more in state capacity. This is captured by the parameter $\delta$ and $\psi$, the former being the discount factor and the latter, office benefits. However, in a clear illustration of the trade-off implied between investing in state capacity and resorting to patronage to ensure legislative support, the dominant effect is imposed by $s_1$, the share of legislative seats held by the opposition in the first period. I proceed to test this model empirically in the next section, focusing on cabinet positions at the municipal level.

<!--chapter:end:chapters//02-model.Rmd-->

```{r include=FALSE, cache=FALSE}
rm(list = ls(all = T))
# set up ------------------------------------------------------------------
pacman::p_load(
  tidyverse,
  data.table,
  rgdal,
  here,
  R.utils,
  GGally,
  lfe,
  lme4,
  plm,
  broom,
  extrafont,
  rprojroot,
  tmap,
  gridExtra,
  cowplot,
  ggdag,
  scales,
  kableExtra,
  RColorBrewer,
  gghighlight,
  parallel,
  foreach,
  gridExtra,
  naniar,
  knitr
)

knitr::opts_chunk$set(
  eval = T,
  cache = T,
  cache.lazy = F,
  message = F,
  warning = F,
  echo = F,
  fig.height = 5,
  fig.width = 8,
  fig.align = "center"
  # dev = "png"
)

source("scripts/thesis_funs.R")

`%<>%` <- magrittr::`%<>%`
between <- data.table::between
set.seed(1789)
```
# Service delivery

```{r include = F}
source(
  here::here("scripts/thesis_setup.R")
)

source(
  here("scripts/thesis_map.R")
)

school <- fread(
  here("data/censo_escolar/censo_school_mun.csv")
) %>% 
  add_election

class <- fread(
  here("data/censo_escolar/censo_class.csv.gz")
) %>% 
  group_by(
    year,
    dep,
    grade_level
  ) %>%
  summarise(
    num_enroll = sum(num_enroll)
  ) %>% 
  mutate(
    freq = num_enroll/sum(num_enroll)
  )

finbra <- fread(
  here("data/finbra/finbra.csv")
)

# student test scores
saeb_dep <- fread(
  here("data/saeb/saeb_exam_dep.csv")
)

saeb_mun <- fread(
  here("data/saeb/saeb_exam_mun.csv")
)

# rais
rais_mun <- fread(
  here("data/rais/rais_mun.csv.gz")
)

rais_edu <- fread(
  here("data/rais/rais_edu_sample.csv.gz")
)
```

## Introduction

Decentralizing reforms in Brazil have taken place since the democratic transition in 1988. One of the cornerstones of decentralization was delegating responsibility for public service provision to municipal governments. Today, public educationo of infants from 6 to 14 years of age in Brazil falls primarily under municipal jurisdiction.^[@falleti_decentralization_2010, @eaton_politics_2004.] This transfer of responsibility was accompanied by the rapid expansion of a street-level bureaucracy and mid-level management, geared towards providing educational services to students.^[@lipsky_street-level_1983.] Understanding the characteristics of this bureaucratic network is the main objective of this chapter.

Who are these bureaucrats responsible for delivering public education in municipalities across Brazil? What role do they play in the administration of these services? What are their characteristics, from both a professional standpoint and in terms of quality of services delivered? Leveraging micro-level data and reports generated internally by the Brazilian government, I provide descriptive statistics of over 1 million municipal teachers and school principals spread across the country. I document changes over time, focusing on a set of covariates: work experience, education level, pupil teacher-ratio, among other key indicators of the structure of this educational bureaucracy.

Any story of bureaucracy is incomplete without the politics. As noted by @eaton_teachers_2014, educational staff is not impervious to political processes. While not the primary focus of this chapter, I highlight supportive evidence that the management of educational services intersects with electoral cycles. Interviews collected during fieldwork in the state of Ceará in the summers of 2018 and 2019 lend support to the hypothesis that schools and educational staff are subject to intense turnovoer as a result of political administration. I test this more rigorously in the following chapter: turnover.

## Who depends on public education?

One of the most concerning features of public education in Brazill is that primary education is almost exclusively dependant on municipal governments. Crucial, formative steps in the cognitive development of infants depend on the quality of formal instructioon offered in schools, such as verbal and mathematical literacy. Where that pipeline is broken, school evasion and drop-out are unfortunately common, with often irreversible damage to the educational formation of these children.

As noted before, decentralization has transferred responsibility for the education of students 

```{r}
class %>% 
  mutate(
    stage = case_when(
      between(grade_level, 1, 4) ~ "lower school",
      between(grade_level, 5, 9) ~ "middle school",
      T ~ NA_character_
    )
  ) %>% 
  filter(
    !is.na(stage), 
    dep != "federal"
  ) %>% 
  group_by(
    stage,
    year,
    dep
  ) %>% 
  summarise(
    n = sum(num_enroll)
  ) %>% 
  mutate(
    freq = n/sum(n)
  ) %>% 
  ggplot(
    aes(
      year,
      freq,
      col = dep
    )
  ) +
  geom_line() +
  geom_point(
    size = 2
  ) +
  facet_wrap(
    . ~ stage,
    nrow = 1
  ) +
  ggtitle(
    "Relative frequency of student enrollment by administration"
  )
```

```{r}
saeb_dep %>%
  filter(
    dep != "",
    dep != "particular",
    year >= 2003
  ) %>% 
  mutate(
    year = as.factor(year)
  ) %>% 
  ggplot(
    aes(
      year, mean_grade_exam, 
      group = dep, col = dep
    )
  ) + 
  geom_line() +
  geom_point() +
  ggtitle(
    "Prova Brasil Mean Scores by Admistration"
  ) +
  labs(
    caption = "Average test scores, by administrative level. Includes math and Portuguese test scores."
  ) + 
  facet_wrap(
    grade ~ subject
  )
```

```{r}
finbra %>% 
  gather(
    -cod_ibge_6, -year,
    key = category,
    value = value
  ) %>% 
  group_by(
    year,
    category
  ) %>% 
  summarise(
    value = sum(value)/1e9
  ) %>% 
  filter(
    category != "budget_total"
  ) %>% 
  mutate(
    category = str_remove(category, "budget_")
  ) %>% 
  ggplot(
    aes(
      year,
      value,
      fill = category
    )
  ) +
  geom_area()
```

```{r}
rais_mun %>% 
  filter(
    str_detect(cbo_category, "education"),
    year >= 1996
  ) %>% 
  group_by(
    year,
    cbo_category
  ) %>% 
  summarise(
    hired = sum(mean_hired*total)/sum(total),
    fired = sum(mean_fired*total)/sum(total)
  ) %>%
  gather(
    "type",
    "percent",
    -year,
    -cbo_category
  ) %>% 
  ungroup() %>% 
  ggplot() + 
  geom_point(
    aes(
      year,
      percent,
      col = type,
      group = type
    )
  ) +
  mandate_year(
    seq(1997, 2013, 4)
  ) +
  ggtitle(
    "Teacher turnover cycles"
  )
```

```{r}
# extract top 5 categories
rais_mun %>% 
  filter(
    cbo_category != "",
    !is.na(cbo_category),
    cbo_category %in% c("administration", "education", "healthcare"),
    year >= 1996
  ) %>% 
  group_by(
    year,
    cbo_category
  ) %>% 
  summarise(
    hired = sum(mean_hired*total)/sum(total),
    fired = sum(mean_fired*total)/sum(total)
  ) %>%
  gather(
    "type",
    "percent",
    -year,
    -cbo_category
  ) %>% 
  ungroup() %>% 
  ggplot() + 
  geom_point(
    aes(
      year,
      percent,
      col = cbo_category,
      group = cbo_category
    )
  ) +
  mandate_year() +
  facet_wrap(
    type ~ .
  )
  ggtitle(
    "Bureaucratic turnover cycles"
  )
```

```{r}
saeb_mun %>% 
  filter(
    dep != "particular",
    dep != ""
  ) %>% 
  group_by(
    year,
    grade,
    dep
  ) %>% 
  summarise(
    mean_grade_exam = weighted.mean(
      mean_grade_exam,
      attendees,
      na.rm = T
    )
  ) %>% 
  ggplot(
    aes(
      year,
      mean_grade_exam,
      group = dep,
      col = dep
    )
  ) +
  geom_line() +
  geom_point(
    size = 3
  ) +
  facet_wrap(
    grade ~ .
  ) +
  mandate_year(
    years = seq(2009, 2013, 4)
  )
```


The empirical analysis of bureaucrats responsible public service delivery is a novel contribution to extant literature on social policy in Latin America. Previous studies have conceptualized social policy primarily from the standpoint of both legislation and clientelistic redistribution.^[@kaufman_globalization_2001, @diaz-cayeros_political_2017.] In order to understand access to public services, scholars have analyzed the implementation of progressive social policies to the rise of leftist parties or coalitions in the turn of the 21st century.^[@haggard_development_2008.] Others have criticized this focus on formal institutions, arguing that informal practices such as clientelism undermine the actual implementation of social policy, leading to perverse accountability in some cases.^[@ross_democracy_2006, @stokes_perverse_2005.]

Beyond the formal and informal analysis of social policies, there is the problem of bureaucratic implementation and that is the focus of this chapter.^[@pepinsky_bureaucracy_1997.] For each social policy, the final point of contact connecting the state to citizen is the bureaucrat delivering the relevant service.^[@lipsky_street-level_1985.] To focus my analysis, I build on extant literature on bureacracies in Latin America and Brazil in particular.^[@grindle_jobs_2012, @geddes_politicians_1994.]

Studies on bureaucracies in Latin American countries have primarily narrowed in on technocratic upper echelons, the commanding heights of the state such as federal-level bureaucrats responsible for determining macroeconomic policy or technological innovation.^[@bersch_state_2017, @kohli_state-directed_2004, @evans_embedded_1995.] Limited focus has been placed on the bureaucratic staff at the municipal level, and even less so at teachers or doctors responsible for delivering these services on the ground.^[@gatti_professores_2009.]

Making precise the object of inquiry requires delving deeper into the structure of educational services in Brazil. This chapter provides an outline of the governmental structure of responsibility for education, as well as the degree of interaction between different levels of government. Moreover, I trace the educational system at the municipal level and myriad evolution paths across time from the standpoint of the personnel. I highlight the historical trends in the quality of educational staff, while also pinpointing the wide heterogeneities which persist. In doing so, I draw inspiration from @arretche_trajetorias_2015, which documents the recent changes in social policy, citing significant improvements in educational outcomes. My focus is on the historical evolution of the municipal education system, from primarily a spatial and temporal perspective. 

The chapter is divided into four sections. The first traces an institutional and organizational history of educational services in Brazil from the municipal level, focusing particularly on the consequences of decentralization on the growth of the educational bureaucracy. The second section focuses on personnel, describing the evolution of educational staff, shedding light on the professional characteristics of teachers and school principals from a nation-wide, municipal perspective. This contrasts with more anecdotal analyses of local educational systems, such as @abrucio_gestao_2010.^[For an exception, see @gatti_professores_2009.]

The third section lays out the framework for linking educational staff to the electoral cycle. I describe how cycles of brueaucratic turnover align with the electoral calendar, raising concerns as to the degree of alignment between political interests over patronage and personnel management. Estimates of the relationship between  is to be found in the executive decisions made by mayors who are elected into office since they have sole jurisdiction over educational policy. This research agenda will be the subject of the next iteration in this research project.

## A changing educational landscape

In Brazil, the responsibility for primary education, in the formative years from 6 to 14, were historically the responsibility of states, not municipalities. Due to demographic changes, this student body has been declining across most of the regions in Brazil, with the exception of the Northeast. Accompanying these changes is the relocation of the majority of these students under the purveyal of municipal governments, responsible for administering educational services to this growing 

In this analysis, I focus on the teachers responsible for primary education, the equivalent to kindergarten through eight grade in the United States. These are formative years, where students from 6 to 14 years old learn crucial skills such as counting, reading and writing. Since democratization in 1988, the new constitution enshrined primary education as the responsibility of municipal governments. Since then, Brazil's education system has rapidly expanded, with a massive growth in the number of municipal teachers. The dashed lines denote municipal election years.

There has been widespread debate on the potential for patronage by local politicians.^[See @akhtari_political_2015, @brollo_victor_2017, and @robinson_political_2013.] It is important, however, not to assume that patronage is the only mode of hiring at the local level.^[@grindle_jobs_2012, @geddes_politicians_1994, @calvo_who_2004.] To assess whether or not these new teachers are being hired meritocratically or through patronage, we must know who they are. A major contribution of our empirical analysis is leveraging the fine-grained data of the RAIS (Annual Report of Social Information), a micro-level data set collected annually by the Ministry of Labor. We go beyond raw numbers to illuminating teachers' characteristics.^[@gatti_professores_2009.]

\subsection{Who becomes a teacher?}

This section sheds light on who decides to become a teacher in municipalities across Brazil. Teachers tend to be relatively older professionals, with a historically weak educational background. This trend, however, has been shifting over time. While in 1985, only 15 percent had a higher education degree, in 2015 over 60 percent had at least completed university. Figure 2 illustrates this shift across different sectors.


```{r}
rais_edu %>% 
  filter(
    year >= 1995
  ) %>% 
  group_by(
    year
  ) %>% 
  summarise(
    higher_edu = mean(
      rais_edu >= 9,
      na.rm = T
    )
  ) %>% 
  ggplot(
    aes(
      year,
      higher_edu
    )
  ) + 
  geom_line() +
  geom_point() +
  labs(
    caption = "Source: RAIS, Ministry of Labor"
  ) +
  ggtitle(
    "Percentage of municipal teachers with higher education (1995 - 2015)"
  )
```

In fact, it is important to note that despite pessimistic evaluations of the quality of education in Brazil, there has been significant improvements occurring throughout the years. While the public sector lags behind the private in terms of educational background of its teaching personnel, there has been significant improvements over time. More than half of its staff hold higher education degrees.

These improvements have been accompanied by better compensation for public teachers. While in the early 1990's, private teachers received higher wages than their public counterparts, this changed by the 2000's. Currently, the median wage for a public sector teacher stands at around 970 reais (270 US dollars), far more than the median private teacher wage, 575 reais (160 US dollars).

```{r}
rais_edu %>% 
  filter(
    year >= 1995
  ) %>% 
  group_by(
    year
  ) %>% 
  summarise(
    wage = median(
      rais_wage,
      na.rm = T
    )
  ) %>% 
  ggplot(
    aes(
      year,
      wage
    )
  ) + 
  geom_line() +
  geom_point() +
  labs(
    caption = "Source: RAIS, Ministry of Labor"
  ) +
  ggtitle(
    "Median teacher wages (1995 - 2015)"
  )
```

\begin{figure}
    \centering
    \textbf{\small Figure 3: Teacher Wages (1995-2015)}\par\medskip
    \includegraphics[width=9cm, height=9cm, keepaspectratio]{./graphs/teacher_wages.pdf}
    \caption*{\footnotesize \hfill Source: RAIS, Ministry of Labor}
\end{figure}

There has been a steady improvement in the overall professional experience of teachers. The median professional experience of the private sector has remained stable at around 2.5 years, while for the public sector it has increased to over 7 years in 2015. This confirms popular opinion of public sector teaching jobs as inherently more stable than their private counterparts.

```{r}
rais_edu %>% 
  filter(
    year >= 1995
  ) %>% 
  group_by(
    year
  ) %>% 
  summarise(
    wage = median(
      rais_wage,
      na.rm = T
    )
  ) %>% 
  ggplot(
    aes(
      year,
      wage
    )
  ) + 
  geom_line() +
  geom_point() +
  labs(
    caption = "Source: RAIS, Ministry of Labor"
  ) +
  ggtitle(
    "Median teacher wages (1995 - 2015)"
  )
```

```{r}
rais_edu %>% 
  filter(
    year >= 1995,
    !is.na(rais_permanent)
  ) %>% 
  mutate(
    rais_permanent = if_else(
      rais_permanent == 1,
      "tenured", "untenured"
    )
  ) %>% 
  group_by(
    year,
    rais_permanent
  ) %>% 
  summarise(
    tenure = median(
      rais_time,
      na.rm = T
    )
  ) %>% 
  ggplot(
    aes(
      year,
      tenure
    )
  ) + 
  geom_line() +
  geom_point() +
  labs(
    caption = "Source: RAIS, Ministry of Labor"
  ) +
  facet_wrap(
    . ~ rais_permanent 
  ) +
  ggtitle(
    "Median work tenure (1995 - 2015)"
  )
```

\begin{figure}
    \centering
    \textbf{\small Figure 4: Teacher's work tenure (1985-2015)}\par\medskip
    \includegraphics[width=9cm, height=9cm, keepaspectratio]{./graphs/teacher_time.pdf}
    \caption*{\footnotesize \hfill Source: RAIS, Ministry of Labor}
\end{figure}

Finally, the proportion of teachers who are offered a permanent contract has decreased dramatically since 2002. There is also an increase in the turnover rate, a natural development given the lower job security offered by temporary contracts. Figures 5 and 6 illustrate these changes. This development raises concerns over the level of expertise which these teachers can develop given such high attrition through different administrations.^[See @gailmard_slackers_2007, @akhtari_political_2015.] Furthermore, social ties with the community are important, a process which naturally takes time and may be more difficult to accomplish when contracts are temporary.

```{r}
rais_edu %>%
  filter(
    year >= 1995
  ) %>% 
  group_by(
    year
  ) %>% 
  summarise(
    hired = mean(rais_hired == 1, na.rm = T),
    fired = mean(rais_fired == 1, na.rm = T)
  ) %>% 
  ungroup() %>% 
  gather(
    "key",
    "value",
    -year
  ) %>%
  ggplot(
    aes(
      year,
      value,
      color = key
    )
  ) +
  geom_line() +
  geom_point() +
  mandate_year()
```

\begin{figure}
    \centering
    \textbf{\small Figure 5: Turnover Rate of Teachers (1995-2015)}\par\medskip
    \includegraphics[width=9cm, height=9cm, keepaspectratio]{./graphs/fired_hired_teacher.pdf}
    \caption*{\footnotesize \hfill Source: RAIS, Ministry of Labor}
\end{figure}

\begin{figure}
    \centering
    \textbf{\small Figure 6: Share of Contracts by Type (1995-2015)}\par\medskip
    \includegraphics[width=9cm, height=9cm, keepaspectratio]{./graphs/perm_temp.pdf}
    \caption*{\footnotesize \hfill Source: RAIS, Ministry of Labor}
\end{figure}

There is extensive argument and criticism of the Brazilian bureaucracy as overstaffed, overpaid and incompetent.^[See @cardoso_jr_burocracia_2011.] Bureaucrats are either hired through clientelistic practices or, once hired, choose not to exert any effort.^[@calvo_who_2004. For a discussion of bureaucrat effort and principal-agent models, see @gailmard_formal_2012.] We often assume that public sector hiring is evidence of patronage, without inquiring who precisely is entering the cadres of our public service.

The data presented in this chapter seeks to redress some of these common perceptions. Despite widespread criticism, there is evidence of significant improvements in the teaching staff, albeit with a large variation across municipalities. It is erroneous to uniformly critique Brazil for its educational failures. The truth is, there are some municipalities which have improved their educational staff while others have failed to do so.

\subsection{Going Local}

We provide a spatial visualization of three major changes in teaching personnel in the past two decades. The first is with regard to the educational formation of teachers. In 1996, the new Law of Basic Education Principles (*Lei de Diretrizes da Educação Básica*) stipulated that teachers from lower to middle school were legally mandated to have a higher education degree. A 10-year buffer was given.

Unsurprisingly, at first very few municipalities obeyed the law. As time progressed, however, we see an increase in the number of teachers who hold a higher education degree. This development is accompanied by a decrease in the number of teachers who have at most completed middle school. This is an important change: because of the ceiling effect in terms of education, other regions such as the Northeast and the North have caught up with their more developed neighbors to the south.

Figure 7 illustrates these changes. The proportion of teachers who have received a higher education degree has increased in a significant proportion of the country, spreading at first in the Southeastern region but later spreading along the North and Northeastern corridor. There still remain areas which are staffed by a large proportion of teachers who have not completed college.

\begin{figure}
    \centering
    \textbf{Figure 7: Percentage of Municipal Teachers with Higher Education Degree}
     \begin{subfigure}{0.4\textwidth}
        \centering 
        \includegraphics[height=8in]{./maps/edu/edu_high_2000.png}
        \caption{2000}
    \end{subfigure} %
    \begin{subfigure}{0.4\textwidth}
        \centering
        \includegraphics[height=8in]{./maps/edu/edu_high_2005.png}
        \caption{2005}
    \end{subfigure} \\
    \begin{subfigure}{0.4\textwidth}
        \centering
        \includegraphics[height=8in]{./maps/edu/edu_high_2010.png}
        \caption{2010}
    \end{subfigure} %
    \begin{subfigure}{0.4\textwidth}
        \centering
        \includegraphics[height=8in]{./maps/edu/edu_high_2015.png}
        \caption{2015}
    \end{subfigure}
    \caption*{\footnotesize \hfill Source: RAIS, Ministry of Labor}
\end{figure}

The second empirical finding relates to the attrition rate of teachers, measured as the teacher's average years working at the municipality. Figure 8 highlights these changes spatially. The northeast and the south are notable for having a more stable personnel, as compared to other regions in Brazil. In particular, coastal areas - which tend to be more densely populated - have a lower attrition rate.

This may be a reflection of the rapid expansion of the educational system in less developed municipalities. Given the need to fill out positions, it may be necessary to recruit new teachers, which necessarily brings down the average years of work in the municipality. Of course, this may be accompanied by job instability, with municipalities firing teachers at a high rate, which may have negative repercussions for students' educational performance.^[@stinebrickner_empirical_1998.]

\begin{figure}
    \centering
    \textbf{Figure 8: Average Years of Work for Municipal Teachers}
    \begin{subfigure}{0.4\textwidth}
        \centering 
        \includegraphics[height=8in]{./maps/time/time_2000.png}
        \caption{2000}
    \end{subfigure} %
    \begin{subfigure}{0.4\textwidth}
        \centering
        \includegraphics[height=8in]{./maps/time/time_2005.png}
        \caption{2005}
    \end{subfigure} \\
    \begin{subfigure}{0.4\textwidth}
        \centering
        \includegraphics[height=8in]{./maps/time/time_2010.png}
        \caption{2010}
    \end{subfigure} %
    \begin{subfigure}{0.4\textwidth}
        \centering
        \includegraphics[height=8in]{./maps/time/time_2015.png}
        \caption{2015}
    \end{subfigure}
    \caption*{\footnotesize \hfill Source: RAIS, Ministry of Labor}
\end{figure}

In Brazil, there are primarily two ways through which teachers get hired. The first one is through a public examination (*edital*) and offering of a permanent contract after a two-year examination, the statutary (*estatutário*) regime. The second is through temporary contracts, with no job security guarantee. Although the law stipulates that all teachers must pass a public exam, it does not guarantee permanent employment, being that decision relegated to local governments.

This development merits further inquiry. On the one hand, some scholars have argued that career security is an important requirement for the acquisition of expertise by bureaucrats.^[@gailmard_slackers_2007, @evans_embedded_1995, @fukuyama_what_2013.] On the other, scholars have argued that one of the reasons for bureaucracies' inefficiency was precisely that rigidity and lack of sanctioning of non-performing staff through firing.^[@grindle_jobs_2012. The New Public Management (NPM) movement was based on this reasoning, see @osborne_new_2006.]

The third and final empirical finding is with regard to the evolution of wages. As noted above, the past decades have seen a significant increase in the salaries of teachers. Mapping this across municipalities show that this improvement has been widespread throughout the national territory. While in the early 2000's, most of the high-paying municipalities were concentrated in the south and southeast, there has been a wage increase in other regions as well.

\begin{figure}
    \centering
    \textbf{Figure 9: Average Municipal Wages for Teachers}
    \begin{subfigure}{0.4\textwidth}
        \centering 
        \includegraphics[height=8in]{./maps/wage/wage_2000.png}
        \caption{2000}
    \end{subfigure} %
    \begin{subfigure}{0.4\textwidth}
        \centering
        \includegraphics[height=8in]{./maps/wage/wage_2005.png}
        \caption{2005}
    \end{subfigure} \\
    \begin{subfigure}{0.4\textwidth}
        \centering
        \includegraphics[height=8in]{./maps/wage/wage_2010.png}
        \caption{2010}
    \end{subfigure} %
    \begin{subfigure}{0.4\textwidth}
        \centering
        \includegraphics[height=8in]{./maps/wage/wage_2015.png}
        \caption{2015}
    \end{subfigure}
    \caption*{\footnotesize \hfill Source: RAIS, Ministry of Labor}
\end{figure}

In sum, the empirical evidence presented in these sections demonstrate that there have been widespread improvements in the educational staff in Brazil. Despite criticisms of an ineffective education system, it is clear that the educational staff is better educated and paid than in any other period in history. The question is then why do we still observe such lackluster educational outcomes. Some of the answers may be found in the poor state of our education infrastructure. This is the focus of our next section.


\section{Schools in a changing landscape}

\subsection{Infrastructure gaps} 

In this section, we delve into Brazil's educational infrastructure. Using data from the School Census (*Censo Escolar*), we present an overview of the changes that have occurred in school infrastructure over the last two decades, focusing primarily on municipal schools.

The School Census has been conducted since 1995, on an annual basis, by the Ministry of Education (MEC) and it is the most important source of information about basic education (primary and secondary education) in Brazil. The amount of information collected by the School Census increased dramatically over the years and this can be perceived by the changes in the structure of the data collected.

Between 1995 and 2006, the unit of analysis of the School Census was “schools”. After 2007, the information collected expanded and MEC disaggregated the data into four datasets: schools, classrooms, teachers and enrollment. Each contains a different unit of analysis, that reflects their content (in the case of the enrollment dataset, the student is the unit of analysis).

The importance of understanding the changes in the education infrastructure is related to the impact it can have over student performance and attendance. ^[@branham_wise_2004, @murillo_school_2011.] Therefore, not only teaching personnel, as described in previous sections, but also the school’s conditions can affect the overall educational performance of students.

The next sections discuss this issue on two main fronts: the gap between private and municipal schools; and the gap in the school’s infrastructure by region. We identify a catch-up effect of municipal schools with regard to the private sector. Also, despite recent developments, regional discrepancies remain striking. The Northeast and North regions – known to be the poorest administrative regions in Brazil, also have the worst conditions of school infrastructure.

\subsection{Private versus Municipal schools}

As previously discussed, the general perception in Brazil is that economic inequality promotes the creation of a few private elite education institutions amidst an underfunded and crowded public education system. This impression is largely correct as Figures 10 and 11 show, both in terms of the size of the public sector, but also in probabilistic terms, as it is more unlikely for a student to be in the private sector. Moreover, given that the current Brazilian Constitution delegates basic education to municipalities, we include only private primary and secondary schools.^[Even though the Constitution of 1988 delegates the task to the municipal governments, there are some primary and secondary schools run by States and by the Federal government. However, the number of municipal public schools overshadow the number of primary and secondary schools controlled by the two other entities. For example, regarding active schools focus in basic education in Brazil, in 2016 there were 115489 municipal public schools, compared to 30999 State public schools and to only 687 Federal public schools.]

\begin{figure}
    \centering
    \textbf{Figure 10: Number of schools (Total)}
    \includegraphics[width=.85\linewidth, keepaspectratio]{./graphs/plots_schools_active.pdf}
    \caption*{\footnotesize \hfill Source: INEP, Ministry of Education}
\end{figure}


In this sense, Figure 10 compares the size of municipal and private sectors as the number of primary and secondary schools. Surprisingly, the number of municipal schools is decreasing. It is necessary to analyze more carefully the data, but we conjecture that this phenomenon is related to a population decline and, hence to a drop in enrollments, rather than a decrease in funding or poor management of the public sector.^[[ http://tiny.cc/gfbity](https://g1.globo.com/educacao/noticia/cai-numero-de-matriculas-no-ensino-fundamental-e-no-ensino-medio-das-escolas-publicas-diz-censo-escolar.ghtml).]

\begin{figure}
    \centering
    \textbf{\small Figure 11: Proportion of students in private schools by municipalities (1995-2016)}\par\medskip
    \includegraphics[width=9cm, height=9cm, keepaspectratio]{./graphs/censo_esc_prob_private.pdf}
    \caption*{\footnotesize \hfill Source: INEP, Ministry of Education}
\end{figure}


Finally, Figure 11 also corroborates the widespread perception in Brazil that private education is the privilege of a few. Between 1995 and 2016, the median probability of a student attending a private school is 5%. This scenario did not change much even during Lula’s government (2003-2010), period in which Brazil experienced an economic boom and upward social mobility.

Figures 10 and 11 confirm that most children and teenagers in Brazil continue to attend municipal schools. The problem is that most of these students attend schools that are far inferior to their private counterpart with respect to their infrastructure. Municipal schools are less likely to have access to internet, computer, running water, among other deficiencies. This is the core debate of the next section.

\subsection{Bridging the gap}

Using data from School Census, we find enormous gaps between private and public schools different, especially in terms of infrastructure. Nonetheless, municipal schools have improved dramatically over the last two decades. We design a two-fold comparison. The first focuses on basic services, such as clean water and restrooms, and the second on the availability of assets per student: teacher, computer and internet.

Unfortunately, deficient services provision distinguish private from municipal schools. Figures 12 and 13 reveal a dismal scenario, of poor access to tap water and inexistence of restrooms in municipal schools. For example, in 2016 the median municipality had 75% of its schools with access to tap water, while for private schools the median was 100% since 1995. Still, between 1997 and 2016, tap water access in municipal schools more than tripled and this trend continues. 

Regarding existence of restrooms in municipal schools, the results are more positive, though not perfect. In 1997, the median municipality had just over 75 percent schools with restrooms inside their building. The median reached the mark of 100 percent in 2005, but there are still some municipalities in Brazil without any restrooms in their schools. Meanwhile, the data from the private schools show that since 1997 just some outliers did not have restrooms. The vast majority of private schools have restrooms inside their building since the beginning of the School Census.

\begin{figure}
    \centering
    \textbf{\small Figure 12: Proportion of Schools with water suplly by sector (1997-2016)}\par\medskip
    \includegraphics[width=9cm, height=9cm, keepaspectratio]{./graphs/censo_esc_water.pdf}
    \caption*{\footnotesize \hfill Source: INEP, Ministry of Education}
\end{figure}

\begin{figure}
    \centering
    \textbf{\small Figure 13: Proportion of Schools with restrooms by sector (1997-2016)}\par\medskip
    \includegraphics[width=9cm, height=9cm, keepaspectratio]{./graphs/censo_esc_toilet.pdf}
    \caption*{\footnotesize \hfill Source: INEP, Ministry of Education}
\end{figure}

Moving on to the second set of comparison, the availability of teachers and computers per student show a continuous improvement in the municipal public schools. Indeed, during the entire period, private schools have outperformed: more teachers and more computer per student. Nonetheless, the effort to improve municipal schools can be seen in Figure 14 and Figure 15. Both Figures highlight the steady increase on the investments in human resources and in computers done by municipal schools in Brazil.

\begin{figure}
    \centering
    \textbf{\small Figure 14: Proportion of Pupil-Teacher Ratio by sector (1995-2016)}\par\medskip
    \includegraphics[width=9cm, height=9cm, keepaspectratio]{./graphs/censo_esc_tcher_stud.pdf}
    \caption*{\footnotesize \hfill Source: INEP, Ministry of Education}
\end{figure}


\begin{figure}
    \centering
    \textbf{\small Figure 15: Number of computer per student by sector (1997-2016)}\par\medskip
    \includegraphics[width=9cm, height=9cm, keepaspectratio]{./graphs/censo_esc_comp_stud.pdf}
    \caption*{\footnotesize \hfill Source: INEP, Ministry of Education}
\end{figure}

We provide data on internet access by sector in Figure 16. The data reveal that even the private schools struggled to have a median of 100 percent. In contrast, municipal schools are close to a median of 75 percent in 2016, in spite of a boost in the probability of having internet access between 2010 and 2011.
<!-- ^[Figure 16 show a spike in the probability of municipal schools to have internet access between 2005 and 2006. During these two years, School Census changed the question and, instead of the affirmative version, asked if the school did not have internet access. Our coding reflected the change done by the Census, but for municipal schools the data is still discrepant.]  -->

\begin{figure}
    \centering
    \textbf{\small Figure 16: Proportion of schools with internet access by sector (1999-2016)}\par\medskip
    \includegraphics[width=9cm, height=9cm, keepaspectratio]{./graphs/censo_esc_internet.pdf}
    \caption*{\footnotesize \hfill Source: INEP, Ministry of Education}
\end{figure}

Usually in the developed world, internet is an elementary part of the educational system. Teachers use the web to enrich classroom material and students are encouraged to do online research. Until 2010, half of the municipalities had at most a quarter of their schools with internet access. In 2016, this improves to three quarters of schools with internet access. 

However, as we are going to explore in the next section, this improvement was not uniform. Some municipalities had a faster and/or a better development over the period than others. Therefore, the focus of the next section is to unveil these differences among municipal public sectors.

\subsection{A Regional Tale}

Brazil is characterized by wide interregional differences. These span economic development, infrastructure, and, of course, education. In this section we provide a visualization of these regional inequalities. These maps allow us to see the extent of the gap which persist between education systems across the national territory. We focus on two variables: internet access and PTR (pupil to teacher ratio).

Figure 17 and 18 reveal that between 2000 and 2015, the vast majority of Brazilian municipalities saw an improvement both in terms of internet access and PTR. Nevertheless, the disparity between regions is remarkable and persist over time.^[The findings are the same if we had pick up other characteristics, such as existence of restrooms, electricity, tap water or sewer service.] Municipal public schools in the Northeast and North are in far worse shape than in other regions.

The difference between regions reflects a broader socio-economic difference between Brazilian regions. Nonetheless, what these maps highlight is that even within regions there are municipalities that have a good quality of infrastructure and investment in personnel when comparing to its neighbors. These “islands of excellence” will be the main focus of our future research agenda. The question is what explains these outcomes.

\begin{figure}
    \centering
    \textbf{Figure 17: Proportion of Municipal Schools with Internet}
    \label{fig:map_internet}
     \begin{subfigure}{0.4\textwidth}
        \centering 
        \includegraphics[height=8in]{./maps/internet/internet_2000.png}
        \caption{2000}
    \end{subfigure} %
    \begin{subfigure}{0.4\textwidth}
        \centering
        \includegraphics[height=8in]{./maps/internet/internet_2005.png}
        \caption{2004}
    \end{subfigure} \\
    \begin{subfigure}{0.4\textwidth}
        \centering
        \includegraphics[height=8in]{./maps/internet/internet_2010.png}
        \caption{2010}
    \end{subfigure} %
    \begin{subfigure}{0.4\textwidth}
        \centering
        \includegraphics[height=8in]{./maps/internet/internet_2015.png}
        \caption{2015}
    \end{subfigure}
    \caption*{\footnotesize \hfill Source: INEP, Ministry of Education}
\end{figure}


\begin{figure}
    \centering
    \textbf{Figure 18: Number of teacher per student in Municipal Public Schools}
    \label{fig:map_tcher_stud}
     \begin{subfigure}{0.4\textwidth}
        \centering 
        \includegraphics[height=8in]{./maps/tcher_stud/tcher_stud_2000.png}
        \caption{2000}
    \end{subfigure} %
    \begin{subfigure}{0.4\textwidth}
        \centering
        \includegraphics[height=8in]{./maps/tcher_stud/tcher_stud_2005.png}
        \caption{2005}
    \end{subfigure} \\
    \begin{subfigure}{0.4\textwidth}
        \centering
        \includegraphics[height=8in]{./maps/tcher_stud/tcher_stud_2010.png}
        \caption{2010}
    \end{subfigure} %
    \begin{subfigure}{0.4\textwidth}
        \centering
        \includegraphics[height=8in]{./maps/tcher_stud/tcher_stud_2015.png}
        \caption{2015}
    \end{subfigure}
    \caption*{\footnotesize \hfill Source: INEP, Ministry of Education}
\end{figure}

\section{Conclusion and next steps}

This study sheds light on Brazil's educational system, focusing on both its personnel and infrastructure. There are two major gaps that structure our analysis: private-public and public-public. Unsurprisingly, the private-public is enormous: internet adoption, PTR, education level of teachers, computers, restrooms, among others, are far superior in the private sector.

Despite this, there have been improvements in the public sector, a catch-up effect that has occurred primarily in the last decade. This is a result of greater investment in education as a result of the commodity boom, and the enshrinement of education as a budgetary priority which occurred in the last governments.

The other gap is the public-public. We outline regional inequalities in educational infrastructure and personnel, while being cognizant that these wide brushstrokes obscure intraregional differences. The existence of "islands of excellence" needs to be explained, systematically and theory driven. Good government in the tropics, as outlined by Tendler, should not be an exceptional case: it needs to be explained.^[@tendler_good_1997.]

In Brazil's scholarly community, there have been widespread debates on the successful case of Sobral, in the state of Ceará. It is a municipality located in one of the poorest states, yet it was able to invest in its educational system and had positive results in student performance. However, the $n$ is 1: how exceptional is Sobral really? Is it possible that other municipalities have followed a similar trajectory of improvement? And why?

This is what motivates the next step in our project, which is to provide a theoretical framework to explain these changes. Investments in education cannot be explained solely by path dependence: there is room for agency. With the sea of data available to us, researchers, there can be multiple Sobral's which emerge across Brazil. Treating them systematically, understanding how and why these occur will be the next iteration of our research agenda.

<!--chapter:end:chapters//03-service_delivery.Rmd-->

```{r include=FALSE, cache=FALSE}
rm(list = ls(all = T))
# set up ------------------------------------------------------------------
pacman::p_load(
  tidyverse,
  data.table,
  rgdal,
  here,
  R.utils,
  GGally,
  lfe,
  lme4,
  plm,
  broom,
  extrafont,
  rprojroot,
  tmap,
  gridExtra,
  cowplot,
  ggdag,
  scales,
  kableExtra,
  RColorBrewer,
  gghighlight,
  parallel,
  foreach,
  gridExtra,
  naniar,
  knitr
)

knitr::opts_chunk$set(
  eval = T,
  cache = T,
  cache.lazy = F,
  message = F,
  warning = F,
  echo = F,
  fig.height = 5,
  fig.width = 8,
  fig.align = "center"
  # dev = "png"
)

source("scripts/thesis_funs.R")

`%<>%` <- magrittr::`%<>%`
between <- data.table::between
set.seed(1789)
```
# Electoral Acccountability

```{r}
# municipal scores
saeb_student_mun <- fread(
  here("data/saeb/saeb_exam_mun.csv")
) %>% 
  filter(
    subject == "port"
  )

mayor <- fread(
  here("data/tse/mayor.csv")
)

# accountability estimation
saeb_election <- saeb_student_mun %>% 
  group_by(
    cod_ibge_6,
    election_year
  ) %>% 
  summarise(
    mean_grade_exam = mean(mean_grade_exam, na.rm = T)
  ) %>%
  group_by(
    cod_ibge_6
  ) %>% 
  mutate(
    mean_grade_exam_lag_1 = dplyr::lag(mean_grade_exam, 1, order_by = election_year),
    mean_grade_exam_lag_2 = dplyr::lag(mean_grade_exam, 2, order_by = election_year),
    delta_mean_grade_exam = 100*(mean_grade_exam_lag_1 - mean_grade_exam_lag_2)/mean_grade_exam_lag_2
  ) %>% 
  ungroup()

accountability <- mayor %>% 
  group_by(
    cpf_candidate
  ) %>% 
  arrange(
    desc(election_year)
  ) %>% 
  mutate(
    vote_lag = dplyr::lag(vote, order_by = election_year)
  ) %>% 
  ungroup() %>% 
  group_by(
    cod_ibge_6,
    election_year
  ) %>% 
  mutate(
    total_vote = sum(vote, na.rm = T),
    n_candidate = n()
  ) %>% 
  ungroup() %>% 
  filter(
    incumbent == 1,
    n_candidate > 1 # drop elections with only 1 candidate
  ) %>% 
  left_join(
    saeb_election,
    by = c("cod_ibge_6", "election_year")
  ) %>% 
  mutate(
    state = str_sub(cod_ibge_6, 1, 2),
    election_year = as.factor(election_year),
    gender = if_else(gender == 2, "male", "female"),
    elected = if_else(outcome == "eleito", 1, 0),
    vote_share = vote/total_vote*100
  )
```

## Introduction

In this chapter, I focus on the final link in the causal mechanism of my theory: does improving the quality of public services (education) reward politicians electorally? If so, a key assumption of the model is confirmed: good performance in the first term rewards incumbents with reelection. The empirical test presented here builds on an extensive data collection process, done in active collaboration with Matheus Soldi Hardt from the University of São Paulo.

Merging this educational dataset with electoral outcomes, I provide an empirical test of whether incumbent politicians are more likely to stay in office when improvements in educational services occurs. This builds on a growing literature on electoral accountability and public service provision in the developing world.^[@boas_electoral_2019, @boas_norms_2019, @ashworth_electoral_2012.] There are good reasons to be skeptical of that final link. The empirical record has been decidedly mixed: while some studies suggest that electoral incentives reduce corruption and boost economic growth (@ferraz_electoral_2011, @besley_does_1995), others have found that providing voters with information on incumbent performance (positive or negative) has no effect in changing electoral outcomes (@boas_electoral_2019, @boas_norms_2019).

I find confirmation that indeed
Before starting my empirical analysis, I review the relevant literature on the topic of electoral accountability and its intersection with public goods provision.

## From clientelism to electoral (un)accountability

Starting with @barro_control_1973, political economists have sought to model how reelection as an institutional feature can potentially induce "good" behavior by politicians. The key feature in these models is a sequential structure and a principal-agent dynamic, where the possibility of reelection motivates office-minded politicians (agents) to provide in their first term the public goods voters (principals) desire, and be rewarded by retaining their office for the second term.^[For an extensive treatment, see @besley_principled_2006.]

With few exceptions, much of this electoral accountability work has remained purely theoretical, with sparse empirical test of their propositions.^[@besley_incumbent_1992, @ferraz_electoral_2011.] Particularly salient is a lack of validation in the context of the developing world, where the predominant mode of analyzing electoral dynamics is through the theoretical lens of clientelism.^[@wantchekon_clientelism_2003, @stokes_brokers_2013.] There are subtle but important differences between these two analytical frameworks worth highlighting before delving into empirical analysis.

Scholars engaging with the problematic of clientelism are principally concerned with patron-client relations.^[@scott_patron-client_1972, @hicken_clientelism_2011.] In particular, the analytical focus is on who gets what in the act of redistribution by a politician (patron) to voters (clients). Debates on the quality of public goods is incidental, at times noting that the allocation of patronage can have a detrimental effect on public goods provision.^[@robinson_political_2013.] A narrow focus on these clientelistic relationships forecloses the analysis of electoral accountability through performance: as long as a sufficient mass of voters are bought-off by a politician, she secures reelection.^[@dixit_determinants_1996.]

The repertoire of strategies for reelection, particularly for incumbents, goes far beyond private transactions between brokers or clients. Some scholars have problematized the distinction between public and private goods outlined in @stokes_brokers_2013, arguing that politicians often engage in a mix of both.^[@min_power_2015.] For instance, @magaloni_clientelism_2007 argues that politicians can diversify their portfolio of public and private goods distribution in order to minimize the risk of each strategy, drawing from financial theories of portfolio allocation, with an empirical test in Mexico. More starkly, @lizzeri_provision_2001 model how politicians opt for either public goods provision or vote-buying according to electoral rules.

Empirically, it is clear that voters are not only bought off, but also care about public goods provision.^[@kaufman_globalization_2001.] The question is if improvements in the delivery of these goods have an effect on the incumbent's probability of reelection. Models of electoral accountability are often focused on comparative statics: does improving the information environment or introducing term limits induce changes in incumbent behavior?^[@ashworth_electoral_2012, @snyder_press_2010. For the effect of term limits, @ferraz_electoral_2011, @besley_does_1995, @besley_political_2003.] Our question is both narrow and foundational: does exerting effort to improve education improve reelection prospects?

## Measuring performance

As outlined in chapter X, there is significant intermunicipal and intertemporal variation in test scores. We illustrate these trends by randomly sampling ten municipalities and plotting the change in municipal average test scores across time. There is a clear serial correlation, as well as an upward trend in municipal average test scores. 

```{r}
saeb_student_mun %>% 
  nest(-cod_ibge_6) %>% 
  sample_n(20) %>% 
  unnest() %>% 
  mutate(
    cod_ibge_6 = as.factor(cod_ibge_6)
  ) %>% 
  ggplot(
    aes(
      year,
      mean_grade_exam_dm,
      group = cod_ibge_6,
      col = cod_ibge_6
    )
  ) +
  geom_point() + 
  geom_line() +
  geom_vline(
    xintercept = seq(2009, 2013, 4),
    linetype = "dashed",
    color = "grey65"
  ) +
  theme(
    legend.position = "none"
  ) + 
  facet_wrap(
    . ~ grade
  ) +
  ggtitle(
    "Annual variation in municipal test scores"
  )
```

The goal of the estimation is to capture the effect of inter-term changes in education test scores on the probability of the incumbent being reelected. Given these conditions, I opt for a first-differences approach to estimate the change in vote share of the incumbent as a result of changes in the educational performance during her mandate.

\footnotesize

```{r, results = "asis"}
fit_acc <- list()

fit_acc$lm <- lm(
  vote_share ~ delta_mean_grade_exam,
  data = accountability
)
  
fit_acc$fe <- felm(
  vote_share ~ delta_mean_grade_exam| election_year + state | 0 | cod_ibge_6,
  data = accountability
)

fit_acc$fe_full <- felm(
  vote_share ~ delta_mean_grade_exam + edu + as.factor(party) + as.factor(gender) + times_office| election_year + state | 0 | cod_ibge_6,
  data = accountability
)

stargazer::stargazer(
  fit_acc,
  title = "Linear Regression",
  omit = c("Constant", "as.factor"),
  header = F,
  single.row = T,
  omit.stat = "F"
)
```

```{r, results = "asis"}
fit_acc_2 <- list()

fit_acc_2$glm <- glm(
  elected ~ delta_mean_grade_exam,
  data = accountability,
  family = "binomial"
)
  
fit_acc_2$glm_fe <- glm(
  elected ~ delta_mean_grade_exam + as.factor(state),
  data = accountability,
  family = "binomial"
)

fit_acc_2$glm_fe_full <- glm(
  elected ~ delta_mean_grade_exam + edu + as.factor(party) + as.factor(gender) + times_office +
    as.factor(state),
  data = accountability,
  family = "binomial"
)

stargazer::stargazer(
  fit_acc_2,
  title = "Logistic Regression",
  omit = c("Constant", "as.factor"),
  header = F,
  single.row = T,
  omit.stat = "F"
)
```

<!--chapter:end:chapters//04-electoral-accountability.Rmd-->

```{r include=FALSE, cache=FALSE}
rm(list = ls(all = T))
# set up ------------------------------------------------------------------
pacman::p_load(
  tidyverse,
  data.table,
  rgdal,
  here,
  R.utils,
  GGally,
  lfe,
  lme4,
  plm,
  broom,
  extrafont,
  rprojroot,
  tmap,
  gridExtra,
  cowplot,
  ggdag,
  scales,
  kableExtra,
  RColorBrewer,
  gghighlight,
  parallel,
  foreach,
  gridExtra,
  naniar,
  knitr
)

knitr::opts_chunk$set(
  eval = T,
  cache = T,
  cache.lazy = F,
  message = F,
  warning = F,
  echo = F,
  fig.height = 5,
  fig.width = 8,
  fig.align = "center"
  # dev = "png"
)

source("scripts/thesis_funs.R")

`%<>%` <- magrittr::`%<>%`
between <- data.table::between
set.seed(1789)
```
# Bureaucratic turnover

```{r}
source(
  here("scripts/thesis_map.R")
)

path <- c(
  here("data/censo_escolar"),
  here("data/saeb")
)

pattern <- c(
  "censo_teacher_turnover_sample|[school|mun]_turnover.csv.gz$|turnover(_sample)?.csv$",
  "hierarchical.csv.gz|student_sample|exam_school"
)

import_data(
  path,
  pattern
) %>% 
  assign_data

spaece <- fread(
  here("data/spaece/spaece.csv")
)

saeb_year <- saeb_student %>% 
  mutate(
    year = as.factor(year)
  ) %>% 
  group_by(
    year
  ) %>% 
  summarise(
    mean_exam = mean(grade_exam, na.rm = T),
    n = n()
  ) %>% 
  ungroup()

censo_turnover_ce <- censo_school_turnover %>% 
  filter(
    state == "23",
    grade_level %in% c(2, 5, 9)
  )

censo_turnover_score <- censo_turnover_ce %>% 
  left_join(
    spaece,
    by = c("cod_ibge_6", "school_id", "year", "grade_level" = "grade")
  ) %>% 
  left_join(
    saeb_exam_school,
    by = c("cod_ibge_6", "school_id", "year", "grade_level" = "grade")
  ) %>% 
  join_covariate() %>% 
  mutate(
    mandate_year = if_else(
      year %in% seq(2005, 2013, 4), 1, 0
    )
  )
```

What explains variation in the quality of educational services? To answer this question, I leverage a set of 

This chapter analyzes bureaucratic turnover and its downstream consequences for public education. I provide novel estimates of teacher turnover, disaggregated at the school level. This fine-grained panel, constructed from micro-level teacher data in Brazil, allows us to further segment turnover and identify hotspots in turnover with respect both to time and observable covariates. A salient feature of Brazilian public education is the inability of translate gains in per student expenditure and rising qualifications into educational gains.

I argue that large part of the  loss in translation is political. The appointment or dismissal procedure of educational staff is under the exclusive jurisdiction of the local executive, encompassing both the mayor and the department of education (\textit{secretaria da educação}). However, these decisions are shaped not only by the executive. In my own fieldwork, I have identified how public sector jobs in education are subject to political pressure, an empirical regularity that has been confirmed in other studies.

This is not the first study to note the prevalence of political interests in shaping the educational bureaucracy in Brazil. In passing, a report organized by the Inep notes that a large proportion of educational administrative staff (\textit{gestores}) are actively involved in local politics. Over two thirds have declared themselves to be affiliated to a political party

While ultimately I am interested in the political determinants of modifications in the bureaucratic structure and how they impinge on the quality of public education, the first step is to understand what factors explain variation in educational performance of students, a proxy for the quality of education at the local level. For each observed student test score, however, there is host of covariates associated with their performance: family background, school infrastructure, municipal sociodemographic characteristics, among others. Educational staff are only one of the factors determining the quality of education received by these students.

Data on educational staff characteristics comes from two sources: the school census and the Annual Report on Social Information (RAIS), a census of all formal municipal workers in Brazil. In the dataset, I can observe information on work experience, type of contract, age, education level and wages. Similar information is available for school principals. Municipal demographic data is collected from population census in two waves, 2000 and 2010. Because I also have micro-level census data, I am considering whether or not to retrieve information on the population sending their children to public education (available for both waves).

How prevalent is teacher turnover in schools? In fieldwork conducted in Ceará, as well as interviews with other scholars studying municipal education, it became apparent that teacher turnover is frequent and pervasive. School migration occurs as a result not of voluntary transfers by teachers, rather they are a product of political decisions made by city councilors to favor members of their constituency. These "spoils" have a potentially detrimental effect on student's educational outcomes. This is the subject of inquiry of this chapter.

In our context, turnover is decomposed into a set of metrics. The relevant unit of analysis is the teacher $i$ at a given school $s$ at time $t$. There are four possible scenarios:

1) A teacher exits the municipal workforce the following year $t+1$ (exit).
2) A teacher stays in the municipal workforce, but is transferred to another school $s_t \neq s_{t+1}$ (transfer).
3) A teacher leaves the school because it is closed down (extinct).
4) A new teacher enters the school (entry) $s_{t-1} \neq s_{t}$.

These different types of turnover can have potentially damaging effects to the quality of eduation received by students. The channels are multiple. The direct effect is in the loss of established socioaffective ties between instructor and students, particularly in contexts where teachers are responsible for the instruction of several years.^[]

```{r}
censo_teacher_turnover_sample %>% 
  calc_turnover(
    "year"
  ) %>% 
  filter(
    between(year, 2009, 2015)
  ) %>% 
  select(
    year,
    starts_with("percent"),
    -percent_extinct
  ) %>% 
  gather(
    -year,
    key = "type",
    value = "measure"
  ) %>% 
  ggplot(
    aes(
      year,
      measure,
      group = type,
      fill = as.factor(type)
    )
  ) +
  geom_area(
    stat = "identity",
    position = "fill"
  )
```

## Descriptives

I first present some stylized facts on the municipal educational system in Brazil. In our sample, over two million children rely on municipally provided public education in Brazil.^[The Brazilian ministry of education performs block sampling by municipality. Only schools with over 10 students are included in the sampling.]

```{r}
saeb_year %>% 
  ggplot(
    aes(
      year,
      n,
      group = 1
    )
  ) +
  geom_line() +
  geom_point()
```

Student test scores are mandatory in Brazilian municipalities and are measured by administering a standardized exam across the territory. Student’s proficiency is estimated using Item-Response Theory (IRT), which is designed to estimate the latent, unobserved proficiency of students across two subjects: Portuguese and Math. Only schools with over ten students are included in the sample.

```{r}
saeb_student %>%
  sample_n(1e5) %>% 
  ggplot() +
  geom_density(
    aes(
      grade,
      col = year,
      fill = year
    )
  ) +
  theme(
    legend.position = "none"
  ) +
  facet_wrap(
    year ~ .,
    nrow = 2
  )
```

##Is it all about development?

```{r}
censo_school_turnover %>% 
  join_covariate() %>% 
  sample_frac(0.25) %>% 
  ggplot(
    aes(
      censo_median_wage,
      turnover_index
    )
  ) +
  geom_point(
    alpha = 0.05
  ) +
  geom_smooth(
    col = "coral3"
  )  +
  scale_x_log10()
```

##What about coalition share?

```{r}
censo_school_turnover %>% 
  sample_frac(0.1) %>% 
  join_covariate() %>% 
  ggplot(
    aes(
      coalition_share,
      turnover_index
    )
  ) +
  geom_point(
    col = "grey95"
  ) +
  coord_cartesian(
    ylim = c(0.2, 0.3)
  )

fit_turnover <- lm(
  turnover_index ~ coalition_share*mandate_year + str_sub(cod_ibge_6, 1, 2),
  data = censo_school_turnover %>% 
    join_covariate() %>% 
    mutate(
      mandate_year = if_else(
        year %in% seq(2005, 2013, 4), 1, 0
      )
    )
)
```

##Time series

```{r}
censo_school_turnover %>% 
  filter(
    between(year, 2008, 2015)
  ) %>% 
  ggplot(
    aes(
      year,
      turnover_index,
      group = year
    )
  ) +
  geom_boxplot() +
  mandate_year(
    seq(2009, 2013, 4)
  )
```

##An itinerant troop

I take a few steps to ensure consistency in my procedure. First, I subset the teacher dataset to those who have only occupied jobs at one school for any gven year. Second, I create a lag column to ensure that I know where in school they were before. Finally, I calculate the percentage of teachers who are no longer working at the same school they were in the previous year.

##How many teachers per mun?

```{r}
censo_mun_turnover %>% 
  gg_histogram(
    aes(n)
  ) +
  scale_x_log10() +
  annotation_logticks()
```

##How many teachers per school?

```{r}
censo_school_turnover %>% 
  gg_histogram(
    aes(n)
  ) +
  scale_x_log10() +
  annotation_logticks()
```

It is curious that in Brazil the modal size of schools is actually one teacher. Which is remarkable. I have heard several times during fieldwork of the problem of multiseries schools, but clearly the problem of one teacher schools is quite prevalent.

##How much rotation, per staff size?

```{r}
censo_school_turnover %>% 
  filter(
    n > 2
  ) %>% 
  mutate(
    school_size = cut_interval(
      n, 5
    )
  ) %>% 
  gg_histogram(
    aes(turnover_index)
  ) +
  facet_wrap(
    school_size ~ .
  )
```

Interesting that turnover seems to increase slightly as the size of staff increases. Not a huge increase but it is there. The beahvior is far more erratic, of course, when we get to small size municipalities.

## Visualizing teacher turnover

```{r eval = F}
map_turnover <- foreach(i = c(paste0("percent_", c("exit", "transfer", "entry"))))%do%{
  censo_mun_turnover %>% 
  filter(
    year == 2015
  ) %>% 
  right_join(
    map_br %>% 
      mutate(
        cod_ibge_6 = cod_ibge_6 %>% 
          as.character %>% 
          as.integer
      ),
    by = c("cod_ibge_6")
  ) %>% 
  plot_map(
    fill = i,
    limits = c(0, 0.5)
  ) +
    ggtitle(
      i
    )
}

grid.arrange(
  map_turnover[[1]],
  map_turnover[[2]],
  map_turnover[[3]],
  ncol = 3
)
```

## What's causing teacher turnover?

Is it a similar story to the one that I have found in the case of rais turnover?

```{r}
censo_turnover_score %>% 
  sample_frac(0.25) %>% 
  ggplot(
    aes(
      coalition_share,
      spaece_mean
    )
  ) +
  geom_point(
    alpha = 0.1
  ) +
  geom_smooth(
    method = "lm", 
    color = "coral3"
  )

censo_turnover_score %>% 
  lm(
    spaece_mean ~ as.factor(grade_level),
    data = .
  ) %>% 
  tidy %>% 
  kable()
```

## State

What are the states where we observe the greatest turnover?

```{r}
censo_teacher_turnover_sample %>% 
  calc_turnover(
    c("state", "year")
  ) %>% 
  nest(-state) %>% 
  mutate(
    avg_turnover = map_dbl(
      data,
      ~mean(.$turnover_index, na.rm = T)
    )
  ) %>%
  top_n(., 8, avg_turnover) %>% 
  unnest() %>% 
  ggplot(
    aes(
      year,
      turnover_index,
      group = state,
      col = as.factor(state)
    )
  ) +
  geom_line() +
  geom_point() +
  mandate_year(
    seq(
      2009, 2013, 4
    )
  )
```

## Explaining student test performance: an application to Brazil

The model that I have preliminarily run is as follows, where the outcome of interest $Y_{ijskt}$
is the student $i$ test score, taught by teacher $k$, in school $s$, in municipality $j$, at time period $t$, for either 5th or 9th grade. The main predictor of interest is teacher and principal turnover, which I measure with a categorical variable that indicates the tenure of both types of educational staff. Note that I can link students to both their teacher and their school principal. Educational staff turnover is intimately linked to political turnover and the entry of new mayors into office.2

$$Y_{ijskt} = \theta Turnover_{jskt} +\psi X_{ijskt} + \gamma V_{jskt} +\chi Wjt+ \alpha_j + \delta_t+ \epsilon_{isjkt}$$
The parameter of interest is $\theta$, whether or not the tenure of the teacher affects student’s test score. Note that t denotes an electoral cycle in this set-up. $X_{ijskt}$ is a matrix of student background covariates, $V_{jskt}$ denotes school characteristics (including school principal), and $W_{jt}$ is the set of municipal covariates. $\alpha_j$ and $\delta_t$ denote state-level (one level above municipality) and electoral cycle unobserved characteristics respectively.

I present the preliminary results below. Total number of observations in-sample is 400 thousand.

```{r models, eval = F}
mods <- list()

mods$lm_base <- lm(
  grade_exam ~ as.factor(year) + as.factor(uf) + mayor_age + mayor_edu_desc + coalition_share +
    saeb_principal_female + saeb_principal_age + saeb_principal_education + saeb_principal_year_as_director +
    saeb_principal_appointment + num_comp + internet +
    age_teacher + education_teacher + type_contract_teacher + wage_teacher + year_as_teacher + year_working_school_teacher +
    age_cat_student + race_student + mother_home_student + mother_edu_student + father_home_student + father_edu_student,
  data = saeb_hierarchical
)

mods$lmer_base <- lmer(
  grade_exam ~ (1|year) + (1|uf) + mayor_age + mayor_edu_desc + coalition_share +
    saeb_principal_female + saeb_principal_age + saeb_principal_education + saeb_principal_year_as_director +
    saeb_principal_appointment + num_comp + internet +
    age_teacher + education_teacher + type_contract_teacher + wage_teacher + year_as_teacher + year_working_school_teacher +
    age_cat_student + race_student + mother_home_student + mother_edu_student + father_home_student + father_edu_student,
  data = saeb_hierarchical %>% 
    sample_frac(0.2)
)
```

```{r graphs, eval = F}
graphs <- list()

graphs$lm_base <- tidycoef(
  mods$lm_base,
  vars = c("coalition_share|^saeb_principal")
)

graphs$lmer_base <- tidycoef(
  mods$lmer_base,
  vars = c("coalition_share|^saeb_principal")
)

print(graphs$lm_base)
print(graphs$lmer_base)
```

##Cascade down effects:

How does teacher turnover affect student’s educational performance? To answer that I leverage data from municipal teachers and students in a developing country: Brazil. Fortunately, Brazil is a data-rich country. For this analysis, I have collected and cleaned datasets that stem from a variety of administrative sources. For student test scores and their family background, I use data from the National System of Basic Education Evaluation (henceforth SAEB), a national level census of schools in Brazil. It includes both municipal, state-level and private schools (voluntary).

Additionally, we add a separate set of tests linking turnover to performance in the SPAECE (Sistema para Avaliação do Ensino no Ceará). This exam complements the findings of the \textit{Prova Brasil}, demonstrating that there is indeed a negative correlation between teacher turnover and student learning outcomes in municipalities across Brazil.

## Prova Brasil

```{r}
censo_turnover_score %>% 
  filter(
    n >= 5,
    grade_level != 2
  ) %>% 
  gg_point_smooth(
    aes(
      turnover_index,
      mean_grade_exam,
      group = grade_level
    )
  ) +
  facet_wrap(
    . ~ grade_level
  )
```

## Spaece

```{r}
censo_turnover_score %>% 
  filter(
    n >= 5
  ) %>% 
  mutate(
    grade_level = recode(
      grade_level,
      `2` = "2nd grade",
      `5` = "5th grade",
      `9` = "9th grade"
    ) 
  ) %>% 
  ggplot(
    aes(
      turnover_index,
      spaece_mean,
      group = as.factor(year),
      col = as.factor(year)
    )
  ) +
  geom_smooth(
    method = lm, formula = y ~ splines::bs(x, 3),
    se = F
  ) +
  theme(
    legend.position = "none"
  ) +
  facet_wrap(
    c("grade_level") 
  ) +
  ggsave(
    "~/princeton/grants/plas/figs/graph_exams_ce.pdf",
    height = 3,
    width = 3
  )

lm(
  spaece_mean ~ turnover_index*grade_level + as.factor(year) + censo_median_wage + censo_lit_rate + censo_log_pop,
  data = censo_turnover_score %>% filter(turnover_index <= 1) %>% 
    mutate(grade_level = as.factor(grade_level) %>% relevel(ref = "5") )
) %>% 
  stargazer::stargazer(
    omit = "as.factor|censo|Constant",
    omit.stat = "f",
    dep.var.labels = "Spaece mean scores (school)",
    covariate.labels = c("Turnover index", "2nd grade", "9th grade", "2nd grade X turnover index", "9th grade X turnover index")
  )
```

<!--chapter:end:chapters//05-turnover.Rmd-->

```{r include=FALSE, cache=FALSE}
rm(list = ls(all = T))
# set up ------------------------------------------------------------------
pacman::p_load(
  tidyverse,
  data.table,
  rgdal,
  here,
  R.utils,
  GGally,
  lfe,
  lme4,
  plm,
  broom,
  extrafont,
  rprojroot,
  tmap,
  gridExtra,
  cowplot,
  ggdag,
  scales,
  kableExtra,
  RColorBrewer,
  gghighlight,
  parallel,
  foreach,
  gridExtra,
  naniar,
  knitr
)

knitr::opts_chunk$set(
  eval = T,
  cache = T,
  cache.lazy = F,
  message = F,
  warning = F,
  echo = F,
  fig.height = 5,
  fig.width = 8,
  fig.align = "center"
  # dev = "png"
)

source("scripts/thesis_funs.R")

`%<>%` <- magrittr::`%<>%`
between <- data.table::between
set.seed(1789)
```
# Coalitional dynamics

```{r include = F}
# read in
cabinet <- fread(
    here("data/rais/rais_cabinet.csv.gz")
  ) %>%
  filter(
    year >= 2005
  ) %>% 
  mutate(
    state = as.factor(str_sub(cod_ibge_6, 1, 2))
  ) %>% 
  join_covariate()

# restrict data to mandate years
cabinet_fit <- cabinet %>%
  filter(
    year %in% seq(2005, 2013, 4)
  ) %>%
  mutate(
    coalition_share = (100 - coalition_share)
  ) %>% 
  mutate_if(
    is.double,
    scales::rescale
  )
  
# import municipal tables
cabinet_mun <- fread(
  here("data/rais/rais_cabinet_mun.csv")
  ) %>%
  filter(
    year >= 2005
  ) %>% 
  mutate(
    state = as.factor(str_sub(cod_ibge_6, 1, 2))
  ) %>% 
  add_election()
  
# restrict data to mandate years
cabinet_mun_fit <- cabinet_mun %>%
  filter(
    year %in% seq(2005, 2013, 4),
    cabinet_size/rais_mun_size <= 0.2
  ) %>% 
  join_covariate() %>% 
  mutate(
    coalition_share = (100 - coalition_share)
  ) %>% 
  group_by(cod_ibge_6) %>% 
  mutate(
    prop_higher_edu_lag = dplyr::lag(prop_higher_edu, order_by = year)
  ) %>% 
  ungroup() %>% 
  mutate_if(
    is.double,
    scales::rescale
  )

# rais data
rais <- gunzip(
  here("data/rais/rais.csv.gz"),
  temporary = T,
  overwrite = T,
  remove = F
) %>%
  fread() %>%
  filter(
    year >= 2005
  ) %>%
  mutate(
    state = as.factor(str_sub(cod_ibge_6, 1, 2))
  )

# municipal rais
rais_mun <- fread(
  here("data/rais/rais_mun.csv.gz")
) %>% 
  group_by(
    cbo_category
  ) %>% 
  mutate_at(
    vars(starts_with("mean")),
    ~weighted.mean(., na.rm = T, w = total)
  ) %>% 
  mutate_at(
    vars(total),
    sum,
    na.rm = T
  ) %>% 
  ungroup()

# restrict data to mandate years
rais_mun_fit <- rais_mun %>%
  filter(
    year %in% seq(2005, 2013, 4)
  ) %>%
  mutate_if(
    is.double,
    scales::rescale
  )

rais_mun_fit <- rais_mun_fit %>%
  join_covariate()

# import municipal tables
rais_cabinet_mun <- fread(
  here("data/rais/rais_cabinet_mun.csv")
) %>%
  filter(
    year >= 2005
  ) %>% 
  join_covariate()

election <- fread(
  here("data/tse/election.csv")
)

mayor <- fread(
  here("data/tse/mayor.csv")
)
```

## Coalitional presidentialism

In Brazil, the executive-legislative bargain has been the object of recurrent research. Since the seminal work of Abranche (1988), scholars have emphasized that the relationship between the president and the national legislature (*Congresso Nacional*) was characterized by coalitional presidentialism.^[@power_optimism_2010.] The term referred to the bargaining process between president and legislators, where governing presidents resorted to the concession of pork and cabinet positions in order to secure support by the legislature for their policy agenda. While there remains debate as to whether presidential coalitionism induces partisan or personalistic voting, there is little controversy that the exchange of administrative posts for legislative votes is widespread in federal politics.^[@figueiredo_presidential_2000, @raile_executive_2011.]

The need for coalitions stems principally from Brazil being characterized by a multipartisan, fragmented system.^[@mainwaring_rethinking_1999, @samuels_presidentialized_2002.] In the absence of a clear majority in the legislature and strong ideological commitments by parties, presidents have to build coalitions through the concession of valuable positions in their cabinet. Positions such as the Ministry of Transportation are particularly valuable since parties controlling it can target infrastructure investments to party members at the state or municipal level. These concessions, however, are costly. Policies over which the president seeks to retain control, such as the Ministry of Finance are generally protected from the political bargains embedded in presidential coalitionism.^[@batista_o_2013, @loureiro_politica_1999.]

This regularity raises the question of what factors help explain variation in the degree of autonomy and politicization of federal bureaucracies and administrative structures under political oversight more generally.^[See @bersch_state_2017.] Scholars have pointed out ideological differences between president and coalition party members, as well as the relative importance of a ministry portfolio to the president as relevant factors in explaining cabinet allocation.^[@batista_o_2013.] However, analysis based on presidential and congressional data faces sample size limitations that make it difficult to assess which presidential characteristics - and congressional ones - explain variation in the degree of instability in bureaucratic structures.

In order to explore these causal mechanisms further, I analyze local legislatures, mayors and bureaucratic positions in municipal Brazil. An analogous political structure, with a separation of power between the mayor and a local legislature occupied by a large number of parties, suggests that a similar coalitional dynamic could be at play. Moreover, in the absence of regulations preventing local politicians from allocating key cabinet positions to coopt legislators, there is good reason to suspect that a similar executive-legislative bargain could be shaping the allocation of public sector jobs in municipalities across Brazil. In the next section, I provide an outline of local government structures and the variation in a key explanatory variable: executive control over legislatures.

## The case: Brazilian municipalities and mayoral coalitionism

How applicable are these analytical building-blocks to the local level? Each and every municipality in Brazil institutionalizes separation of powers. Mayors do not govern alone: with every municipal election, an executive leader and her legislative counterparts take office. Recent studies on local governments in Brazil often overlook this institutional feature, disregarding the fact that municipalities comprise both an executive and legislative branch.^[Most studies analyzing Brazilian governments focus exclusively at mayors. See @brollo_victor_2017, @brollo_tying_2012, @colonnelli_patronage_2017, @klasnja_incumbency_2017.] While mayors have exclusive prerogative over the appointment of local employees and establishing a policy agenda, appointments respond to the need to ensure legislative support.^[Interview with C.F. and F. in SP.]

The municipal legislative chamber plays a central role in municipalities. It is responsible for oversight and vetoing the executive budget, as well as approving and ammending municipal laws. This grants the legislative chamber and its city councillors significant power over the mayor's ability to implement their policy agenda. In order to garner legislative support, it is common for mayors to concede key cabinet positions to city councillors.^[Interview with C.F. and F. in SP.] A set of scholars have started to analyze this tradeoff between legislative support and cabinet allocation at the federal level, but to the best of my knowledge the municipal level is yet to be explored.^[Batista et al. 2018]

While conducting fieldwork research in Brazil, I was struck by the recurrent accounts of the important role played by local city councillors (vereadores) in shaping the bureaucracy. Secretaries of education argue that deputees often demanded to nominate their own loyalists to prominent cabinet positions, with the tacit but careful approval of the mayor.^[Interview with F, chief of staff of a local government in SP.] The degree to which mayors acquiesced to these demands depends on their bargaining power: how many seats their coalition was able to secure in the local chamber. When the executive coalition held a comfortable margin, the need to appease coalition members through appointments was less pressing.^[Similar to the findings of @neto_presidential_2006.] Conversely, budgetary resources can be withheld when mayors are in a minority governemnt.

```{r budget}
rais_cabinet_mun %>% 
  ggplot(
    aes(
      coalition_share,
      budget_total/censo_pop
    )
  ) +
  geom_smooth(
    formula = y ~ splines::bs(x, 3),
    method = "lm",
    col = "steelblue"
  ) +
  stat_summary(
    fun.y = "mean",
    geom = "point",
    col = "coral3",
    alpha = 0.5
  ) +
  theme_clean +
  xlab("Coalition Share") +
  ylab("Budget per Capita") +
  ggtitle("Budget per capita vs. share of legislative seats held\n by the executive coalition")
```

While most mayors tend to hold a majority of seats over the chamber, this is far from being the rule. Note that I am adopting an expansive view of chamber control: if the deputee's party is in the executive electoral coalition that is registered prior to the electoral campaign, I count that seat as being part of the mayoral coalition share. This is similar to the operationalization of presidential control over the congress in presidential coalitionism and based on interviews with municipal secretaries.^[Pereira et al. 2016, Figueiredo and Limongi 2012, Raile et al. 2011.] I exploit this variation, both intermunicipal and across time, in executive coalition shares to explain decisions over bureaucratic turnover.

```{r cabinet coalition share}
election %>%
  ggplot() +
  geom_histogram(
    aes(
      x = coalition_share*100
    ),
    geom = "line",
    col = "cadetblue3",
    fill = "steelblue3",
    alpha = 0.8
  ) +
  geom_vline(
    xintercept = 50, 
    linetype = "dashed",
    col = "darkred"
  ) +
  theme(
    legend.position = "bottom",
    legend.title = element_blank(),
    legend.spacing.x = unit(0.05, "inch")
  ) +
  theme_clean +
  xlab("Coalition Share") +
  ylab("Density") +
  ggtitle("Mayor coalition seat share")
```

Why focus on local bureaucracies? While extant literature on state capacity generally focus analysis on federal bureaucracies, in the past two decades Brazil, along with other Latin American countries, have embarked on ambitious decentralization efforts.^[@falleti_decentralization_2010.] As a result of this efforts, not only public policy implementation, but the number of bureaucratic staff under municipal responsibility has increased rapidly. This growing staff, along with the political principals responsible for hiring them, are only beginning to be empirically explored.^[@colonnelli_patronage_2017, @brollo_victor_2017.] Much remains to be done.

```{r rais time}
rais_mun %>% 
  filter(
    year >= 2003
  ) %>% 
  mutate(
    rais_size = total*4/1e3,
    cbo_category = str_to_title(cbo_category)
  ) %>% 
  group_by(
    cbo_category,
    year
  ) %>% 
  summarise(
    rais_size = sum(rais_size)
  ) %>% 
  ggplot(
    aes(
      x = as.factor(year),
      y = rais_size,
      group = cbo_category
    )
  ) +
  geom_line(
    col = "cadetblue3"
  ) +
  geom_point(
    col = "steelblue3"
  ) +
  xlab("Year") +
  ylab("Number of staff (thousands)") +
  facet_wrap(
    ~ cbo_category,
    ncol = 2,
    scales = "free_y"
  ) +
  scale_x_discrete(
    breaks = seq(2003, 2015, 3)
  ) +
  theme_clean +
  ggtitle(
    "Growth in municipal bureaucracies (by category)"
  )
```


In the next section, I outline the executive's dilemma. I model this in game theoretical terms to embed the bureaucracy in the political game to which it is subjected. Combining insights from the literature on presidential coalitionism, electoral accountability and patronage, I theorize that newly elected mayors face a straightforward sequential optimization problem: the quality of public goods provision is directly observed by the electorate and depends on keeping patronage at a minimum. At the same time, patronage is necessary to buy-off legislative support. The ambition for reelection and the need to coopt the legislative in the current period defines the terms of the politics of patronage. For the full, formal treatment, refer to the appendix.

## The Executive Dilemma:

I build a theoretical framework to explain variation in bureaucratic turnover. A new mayor is elected into office and has the power to reshape the local bureaucracy. To be reelected, she has to convince the electorate that she will provide high quality public goods in her second term, and to do so requires bureaucratic coherence. However, she must also coopt the legislative opposition by divving up a share of the bureaucratic pie for patronage.^[This aligns closely to previous studies on the use of ministerial positions to gain support from opposition members at the federal level. See @loureiro_politica_1999, @loureiro_radiografia_2014, @lopez_cargos_2018.] The model highlights the tradeoff executive politicians face between investing in state capacity and coopting the legislative opposition.

Accomodating a shifting legislative political arena requires introducing new members into the local public machine. Bureaucratic turnover in this model stems from decisions by the executive to distribute jobs for political purposes. This is a particular manifestation of patronage, the allocation of public sector jobs to garner political support.^[@brollo_victor_2017.] Certainly, bureaucratic turnover can take a variety of forms, and my empirical strategy accomodates for its multivariate structure. In the estimation, two outcomes of interest are analyzed: proportion of newly hired cabinet members and proportion of personnel fired.

The theoretical model builds on an extensive literature in the electoral accountability literature, modeling public goods provision as an electoral game played between the voter and the politician. Starting with @barro_control_1973 and @ferejohn_incumbent_1986, political economists have explored models incorporating electoral accountability as an incentive for shaping the behavior of elected politicians.^[See, for instance, @ferraz_electoral_2011.] The possibility of reelection motivates them to put effort into convincing voters to reelect them. @coate_form_1995 and @besley_principled_2006 incorporate voters updating Bayesian beliefs about politician types, a feature applied in my model.

I extend these analyses with a key feature. Instead of assuming that politicians can set the quality of public goods provision, I model it as the probabilistic outcome of an investment in bureaucratic quality and legislative support. Producing better public goods requires an experienced and professional bureaucracy and legislative support. Reshuffling the bureaucracy is costly due to the loss of professional expertise accumulated by the inherited staff, but this underlying capacity is meaningless if the legislative does not grant its approval. The executive does not always control the legislative chamber once in office, and have to coopt them into supporting their agenda.^[Analogous to the concept of minority presidents in the literature on coalitional presidentialism. See @figueiredo_presidential_2000.]

The mayor's strategy centers around a key part of her political resources: the local bureaucracy. A set of public sector jobs is available to the executive for redistribution. Jobs are a valuable resource for cooptation.^[Mayors enjoy full discretion into how to appoint workers into the public sector and often resort to distributing these jobs to appease members of the legislative.] When deciding whether or not to engage in patronage, executive leaders face a dilemma. The mayor can invest in state capacity, retaining expertise and reaping benefits from better public goods provision and retaining office. However, doing so raises the possibility of retaliation by the opposition, who can threaten to bar the provision of public services. This is the executive's dilemma.^[@geddes_politicians_1994.]

## Cabinet share:

Cabinet members are responsible for administering the local executive branches. This includes key functions such as education, health, transportation, among others. The structure of cabinets vary according to the complexity of municipal administrations, often correlated with the population size of the municipality. These are positions of trust (\textit{cargos de confiança}), and the mayor has full discretion in appointing and firing these cabinet members. Consistent with the theoretical model outlined above, I find that reshuffling in cabinet positions is often done with restraint, with a significant share of cabinet members being transferred from previous administrations.

Extant literature on nomination of local cabinets is limited. Apart from anecdotal evidence on nomination practices, scholars in Brazil have not analyzed extensively how municipal cabinet positions are filled.^[Interview with Glauco Peres da Silva, professor at Universidade de São Paulo.] We know little to nothing of what proportion of these bureaucrats are being hired strictly through political nomination, and how the political calculus behind their nomination takes place. In local governments with no obligation to respect civil service laws, one would expect to observe politicians appoint loyalists and eradicate those left over from the previous administration.^[Brollo et al. 2018, Lewis 2008, Lopez et al. 2015.] There are, however, costs to cabinet reshuffling: an inexperienced cabinet member will have a difficult time governing.

Leveraging a unique dataset of local bureaucrats in Brazil, I find that cabinet reshuffling is circumscribed to a fraction of the available positions. Only a small subset of the cabinet is renewed with each mandate. I shed light on temporal dynamics, looking at the proportion of newly hired cabinet positions annually. The proportion of cabinet members who are appointed for their first time is small. There are spikes in cabinet hiring in the first year of mandate, yet this is limited to around a third of available seats. This means that around two thirds of the upper echelon of the local bureaucracies is retained from the previous administration.

```{r new-hires}
# share of new hires
cabinet %>%
  group_by(
    year
  ) %>%
  summarise_mun(
    "rais_hired"
  ) %>% 
  ggplot(
    aes(
      year,
      prop
    )
  ) +
  geom_point(
    col = "cadetblue3"
  ) +
  geom_linerange(
    aes(
      ymax = upper,
      ymin = lower
    ),
    col = "cadetblue3"
  ) +
  scale_x_continuous(
    breaks = seq(2005, 2013, 4)
  ) +
  mandate_year() +
  theme_clean +
  ggtitle("Proportion of newly-hired cabinet members")

# # share of fires
# cabinet %>%
#   group_by(
#     year
#   ) %>%
#   summarise_mun(
#     "rais_fired"
#   ) %>% 
#   ggplot(
#     aes(
#       year,
#       prop
#     )
#   ) +
#   geom_point(
#     col = "cadetblue3"
#   ) +
#   geom_linerange(
#     aes(
#       ymax = upper,
#       ymin = lower
#     ),
#     col = "cadetblue3"
#   ) +
#   scale_x_continuous(
#     breaks = seq(2005, 2013, 4)
#   ) +
#   mandate_year +
#   theme_clean +
#   ggtitle("Proportion of newly-hired cabinet members")
```

The fact that mayors are reelected affects the amount of cabinet turnover observed. Breaking down our data into first-term and reelected mayors, there are clear differences between the two. Mayors elected for the first time tend to hire far more new cabinet members than those who are reelected. Even then, on average only around 35 percent of cabinet positions are renewed with first-term mayors. I now break down hiring of cabinet members by whether or not there is a party or coalition turnover. Intuitively, if it is the same party that remains in power or if members of the coalition accede to executive power. Let's check if that is the case, first analyzing party switches. I exclude from sample mayors who are reelected, where party continuity is trivial. Individual candidates may not run for office again as a lameduck, but their party can field another candidate.

```{r party turnover}
# new hires
cabinet %>%
  filter(
    !is.na(party_turnover)
  ) %>%
  group_by(
    year,
    party_turnover
  ) %>%
  summarise_mun(
    "rais_hired"
  ) %>%
  mutate(
    party_turnover = if_else(
      party_turnover == 1,
      "party turnover", "no turnover"
    )
  ) %>% 
  ggplot(
    aes(
      year,
      prop
    )
  ) +
  geom_point(
    aes(
      col = as.factor(party_turnover)
    )
  ) +
  geom_linerange(
    aes(
      ymax = upper,
      ymin = lower,
      col = factor(party_turnover)
    )
  ) +
  scale_color_manual(
    breaks = c("party turnover", "no turnover"),
    values = c("cadetblue3", "coral3")
  ) +
  scale_x_continuous(breaks = seq(2005, 2015, 2)) +
  mandate_year() +
  theme_clean +
  theme(
    legend.position = c(0.925, 0.95),
    legend.title = element_blank()
  ) +
  ggtitle("Proportion of new hires: party turnover")

# career bureaucrats
cabinet %>%
  mutate(
    party_turnover = if_else(
      mayor_party != mayor_party_lag &
      mayor_reelected != 1,
      1, 0
    )
  ) %>%
  filter(
    !is.na(party_turnover)
  ) %>%
  group_by(
    year,
    party_turnover
  ) %>%
  summarise_mun(
    "rais_permanent"
  ) %>%
  mutate(
    party_turnover = if_else(
      party_turnover == 1,
      "party turnover", "no turnover"
    )
  ) %>% 
  ggplot(
    aes(
      year,
      prop
    )
  ) +
  geom_point(
    aes(
      col = as.factor(party_turnover)
    )
  ) +
  geom_linerange(
    aes(
      ymax = upper,
      ymin = lower,
      col = factor(party_turnover)
    )
  ) +
  scale_color_manual(
    breaks = c("party turnover", "no turnover"),
    values = c("cadetblue3", "coral3")
  ) +
  scale_x_continuous(breaks = seq(2005, 2015, 2)) +
  mandate_year() +
  theme_clean +
  theme(
    legend.position = c(0.925, 0.95),
    legend.title = element_blank()
  ) +
  ggtitle("Proportion of career bureaucrats: party turnover")
```

Remarkably, we find that even when the mayor is **not** reelected, if the same party remains in power, there is significantly less rotation at the top level. This is an interesting finding, that sheds doubt on standard accounts of the weakness of Brazilian parties in constraining executive behavior by individual members.^[@klasnja_incumbency_2017.] Additionally, the proportion of career bureaucrats in the case of party continuity increases when the same party remains in power. These factors will be taken into account when we estimate the impact of the share of seats held by the legislative opposition.

<!-- ## Career bureaucrats: -->

<!-- Let's look at the proportion of cabinet members who are permanent employees. These are career servants in the municipal bureaucracy, who have risen up the ranks and are appointed to cabinet positions. Contrary to what I expected, there is a large proportion of such cabinet members. The graph below illustrates the turnover (proportion of new hires) across each subgroup: temporary and career servants. Far more cabinet members are replaced when offered a temporary contract, as would be expected. -->

<!-- ```{r permanent} -->
<!-- # share of permanent cabinet positions -->
<!-- cabinet %>% -->
<!--   group_by( -->
<!--     year -->
<!--   ) %>% -->
<!--   summarise_mun( -->
<!--     "rais_permanent" -->
<!--   ) %>% -->
<!--   rename( -->
<!--     prop_permanent = prop -->
<!--   ) %>% -->
<!--   ggplot( -->
<!--     aes( -->
<!--       year, -->
<!--       prop_permanent -->
<!--     ) -->
<!--   ) + -->
<!--   geom_point( -->
<!--     col = "cadetblue3" -->
<!--   ) + -->
<!--   geom_linerange( -->
<!--     aes( -->
<!--       ymax = upper, -->
<!--       ymin = lower -->
<!--     ), -->
<!--     col = "cadetblue3" -->
<!--   ) + -->
<!--   scale_x_continuous( -->
<!--     breaks = seq(2005, 2015, 2) -->
<!--   ) + -->
<!--   mandate_year + -->
<!--   theme_clean + -->
<!--   ggtitle("Share of career bureaucrats in cabinet") -->
<!-- ``` -->

<!-- Growing use of career offers in contracts. Ranging from 44% in 2005 to roughly 46% in 2015. Now, I wonder why is it the case that some of these secretaries actually remain with permanent linkages to the local bureaucracy. Is it the case that mayors with stronger control of the legislative hire more career servants? This may very well be the case of the vertical up and down that the coordinators of the PAIC in Quixelô had mentioned to me. This would be fascinating, because in this case we would actually see an internal appointment of secretaries. -->

## Verifying assumptions: reelection in the face of patronage

A working assumption in the literature on clientelism is that patronage pays off: politicians reap electoral benefits from distributing jobs for their followers.^[@brollo_victor_2017, @calvo_who_2004.] For example, @folke_patronage_2011 find that states where civil service laws were not enacted, the party was more likely to remain in power than their professionalized counterparts. The challenge, empirically, is that previous studies rarely assess whether engaging in patronage actually helps incumbents remain in office. I provide an initial step towards this direction. In Brazilian municipalities, it is fairly common for incumbent mayors to run for office. Does engaging in patronage during the first period helps her be reelected into office? Preliminary evidence seems to suggest no.

```{r reelection}
mayor_reelection <- mayor %>% 
  filter(
    election_year >= 2004 & election_year < 2016
  ) %>% 
  left_join(
    rais_cabinet_mun %>% 
      filter(
        year %in% seq(2005, 2013, 4)
      ) %>% 
      transmute(
        cod_ibge_6,
        election_year = election_year + 4,
        mean_hired,
        mean_fired,
        rais_permanent,
        cabinet_size
      ),
    by = c("cod_ibge_6", "election_year")
  ) %>% 
  left_join(
    fread(
      here("data/censo_br/censo_2000.csv")
    ),
    by = c("cod_ibge_6")
  )

# filter incumbents
mayor_reelection <- mayor_reelection %>% 
  filter(
    incumbent == 1
  )

# probability of winning
mayor_reelection %>% 
  group_by(
    mean_hired
  ) %>% 
  summarise(
    elected_prob = mean(elected)
  ) %>% 
  ggplot() +
  geom_smooth(
    aes(mean_hired, elected_prob),
    method = "lm"
  ) +
  theme_clean +
  xlab(
    "Proportion of new hires"
  ) +
  ylab(
    "Probability"
  ) +
  ggtitle(
    "Probability of reelection vs. proportion of new hires"
  )

# logistic
fit_reelection <- list()

fit_reelection <- fit_logit(
  repo = fit_reelection,
  "elected",
  predictor = c("mean_hired"),
  control = c("rais_permanent", "cabinet_size", "gender", "as.factor(party)", "edu", "censo_median_wage", "censo_log_pop"),
  data = mayor_reelection
)

fit_reelection$logit_full %>% 
  tidycoef + 
  scale_y_discrete(
    labels = rev(
      c(
        "Mayor education",
        "Career servants",
        "Municipal median wage",
        "New hires",
        "Population size (logged)",
        "Firing",
        "Gender"
      )
    )
  ) +
  ggtitle("Logit: Probability of reelection vs patronage")
```

The evidence for electoral benefits from engaging in patronage is not clear. In fact, it seems that gender - unsurprisingly - and the education level of the mayor are better predictors of whether or not an incumbent is reelected than indicators for potential patronage: the proportion of newly hired bureaucrats, dismissal rates and career servants in the bureaucracy. These seem to be counterproductive for reelection prospects: an increase in firing and hiring tend to be negatively correlated with reelection, while increases in career servants help While I leave the analysis limited at this point, there is far more to explore with regard to the decision-making process of the electorate in whether or not to retain an incumbent.

## Empirical testing:

The main implication of my theoretical model is that the share of seats held by the legislative opposition will have a negative effect on state capacity. In terms of observable implications, we should see that in municipalities where the mayor faces a strong legislative opposition, she will resort to greater patronage, with more hiring into and less permanent bureaucrats in cabinet positions. Descriptively, we find an inverse, quadratic relationship between the size of the opposition and the proportion of newly hired cabinet members.

```{r visual}
cabinet %>%
  group_by(
    coalition_margin + 0.5
  ) %>%
  mutate(
    prop_hired = mean(rais_hired, na.rm = T)
  ) %>% 
  ggplot(
    aes(
      coalition_margin,
      prop_hired
    )
  ) +
  geom_count(
    alpha = 0.4,
    col = "coral3"
  ) +
  geom_vline(
    xintercept = 0,
    linetype = "dashed"
  ) +
  geom_smooth(
    method = "lm",
    formula = y ~ splines::bs(x, 3),
    col = "cadetblue3"
    # data = . %>% filter(coalition_margin < 95)
  ) +
  coord_cartesian(
    ylim = c(0, 0.35),
    xlim = c(-0.5, 0.5)
  ) +
  xlab("Opposition share") +
  ylab("Proportion of new hires") +
  theme_clean
```

I first naively estimate the relationship between share of opposition legislative seats and the use of patronage, leveraging micro-level bureaucratic data. I regress the bureaucratic turnover (for an individual $Y_{ijt}$ or a municipal proportion $\bar{y_{jt}}$) on the share of legislative seats held by the mayoral opposition. There are two outcomes of interest: new-hires and firing of cabinet members. To account for possible non-linearity, I introduce a quadratic term for opposition share of seats.^[The results are not changed by this inclusion.] I include a set of controls $X_{jt}$, with demographic covariates, bureaucrat's characteristics, political-institutional variables and mayor-level characteristics.^[These include, among others, the size of the municipality, type of bureaucratic contract (permanent or not) mayor partisanship, education level of legislators, effective number of parties and municipal median wage, which I use as a proxy for economic development.] Standard errors are clustered at the year and municipal level for the fixed effects specification. For the micro-level logistic specification, we have:

$$Y_{ijt} = \alpha_j + \delta_t + \beta\times\text{Opposition share}_{jt} + \beta\times\text{Opposition share}^2_{jt} \gamma X_{jt} + \epsilon_{ijt}$$
For the fixed effects regression, the model regresses the proportion of bureaucrats possessing a particular characteristic (e.g. newly-hired) on a similar set of predictors to the specification above. For simplicity, I preserve a similar notation.

$$\bar{y}_{jt} = \alpha_j + \delta_t + \beta\times\text{Opposition share}_{jt} + \gamma X_{jt} + \epsilon_{jt}$$

The estimate of innerest is $\beta$, the effect of opposition share on bureaucratic turnover. In the absence of a credible identification strategy, these estimates are not plausibly causal. However, the sum of these results, albeit confounded, point to a similar substantive result: the proportion of seats controlled by the opposition is positively associated with bureaucratic turnover.
 
The results below are from a logistic regression. This is a simple exercise, but since the level of observation is the individual hiring and there is a clearly hierarchical structure, multi-level modelling seems to be the natural next step to take. I do so below when running the robustness checks.

```{r hiring micro}
fit_hired <- list()

# fit_hired <- glmer(
#   rais_hired ~ (1|year/cod_ibge_6) + coalition_share + 
#     mayor_party + mayor_coalition_size + mayor_reelected +
#     censo_log_pop + censo_median_wage,
#   data = cabinet_fit,
#   family = binomial
# )s

# logit model
fit_hired <- fit_logit(
  fit_hired,
  "rais_hired",
  predictor = "coalition_share + I(coalition_share^2)",
  data = cabinet_fit
)

# print plot
fit_hired$logit_full %>%
  tidycoef + 
  scale_y_discrete(
    labels = c("Opposition share (squared)", "Wage (bureaucrat)", "Median wage", "Mayor reelected", "Career servant", "Education level (bureaucrat)", "Campaign expenditures", "Number of parties in coalition", "Municipal pop. size (logged)", "Opposition share")
  ) +
  ggtitle("Logit: New cabinet hire on\n opposition share of seats")
```

These results point to the importance of executive-legislative relations in the appointment of executive positions. Clearly, campaign contributions also matter and may indicate the occurrence of prebendism in Brazil.^[I explore these patterns in another paper.] Complementing longstanding debates on the relevance of poverty to shape politicians' distribution of patronage, these models point out that local executives behave in accordance with control of the chamber. The coefficient for the share of oppositions seats in the legislative chamber is positive and significant: the more seats the executive controls, the greater the likelihood of a new hire into the cabinet.

These new hires actually can be interpreted as a form of executive "cooptation", but as it stands it is only a suggestive result. Interviews with current and former secretaries confirm that the forging of alliances at the chamber level is conditional on the concession of cabinet positions or, more often, at the directorate level. I now proceed to test a fixed effects model, with the municipality as the unit of analysis.

```{r hiring municipal}
fit_hired_mun <- list()

# clustered ols
fit_hired_mun <- fit_felm(
  fit_hired_mun,
  "mean_hired",
  predictor = c("coalition_share + I(coalition_share^2) + mayor_reelected + prop_higher_edu_lag"),
  data = cabinet_mun_fit
)

# print plot
fit_hired_mun$ols_full %>%
  tidycoef +
  scale_y_discrete(
    labels = c(
        "Opposition share (squared)",
        "Mayor reelected",
        "Median wage (bureaucracy)",
        "Proportion of career servants",
        "Education level of bureaucracy",
        "Effective parties",  
        "Size of bureaucracy", 
        "Mayor age", 
        "Previous cabinet edu",
        "Size of mayor coalition",
        "Opposition share",
        "Campaign expenditures"
      )
  ) +
  ggtitle(
    "FE: Proportion of new cabinet hire on\n opposition share of seats"
  )
```

The results are robust to the above specifications. There is consistent evidence that the share of opposition seats is positively related to hiring of cabinet members. Having documented the importance of legislative opposition in the hiring of cabinet members, I now analyze how firing of cabinet members varies as a result of changes in opposition share.

```{r firing}
# micro-level
fit_fired <- list()

# logistic
fit_fired <- fit_logit(
  fit_fired,
  "rais_fired",
  data = cabinet_fit
)

# print plot
fit_fired$logit_full %>%
  tidycoef +
  scale_y_discrete(
    labels = c(
      "Campaign expenditures",
      "Career servant",
      "Median wage",
      "Mayor reelected",
      "Education level (bureaucrat)",
      "Size of mayor coalition", 
      "Opposition share",
      "Population size", 
      "Wage (bureaucrat)"
    )
    ) + 
  ggtitle("Logit: Fired cabinet members on\n opposition share of seats")

# mun-level
fit_fired_mun <- list()

fit_fired_mun <- fit_felm(
  fit_fired_mun,
  "mean_fired",
  predictor = c("coalition_share + I(coalition_share^2) + mayor_reelected + prop_higher_edu_lag"),
  data = cabinet_mun_fit 
)

# print plot
fit_fired_mun$ols_full %>%
  tidycoef +
  scale_y_discrete(
    labels = rev(
      c(
        "Opposition share",
        "Effective parties",
        "Previous cabinet edu",
        "Education level (bureaucrat)",
        "Mayor reelected",
        "Size of mayor coalition",
        "Mayor age", 
        "Size of bureaucracy",
        "Opposition share (squared)",
        "Proportion of career servants",
        "Median wage (bureaucracy)", 
        "Campaign expenditures"
      )
    )
  ) +
  ggtitle("FE: Proportion of cabinet fired on\n opposition share of seats")
```

There is supporting evidence that firing rates change as a result of the presence of strong legislative opposition in the chamber. Including the full set of control variables indicates that firing rates increases significantly as the opposition takes control of the legislative chamber.

## Robustness checks:

In this section, I take into account the hierarchical structure of bureaucratic turnover. I run a multi-level model with political covariates at the second level, while letting the outcome of interest (bureaucratic turnover) vary at the first level. I find a similar effect for the hierarchical model specification. This adds confidence to the robustness of our results. Of course, there is far more to be done. In particular, the problem of endogeneity is never fully addressed. I am now working on identifying an exogenous shock to coalition structures to causally estimate the effect of changes in coalition share on patronage.

```{r}
# fit multilevel
multilevel_fit <- list()

# multilevel full
multilevel_fit[["coalition_full"]] <- cabinet_fit  %>%
  mutate(
    rais_hired*100
  ) %>% 
  lmer(
    rais_hired ~ (1|year) + (1|state) + I(coalition_share^2) + coalition_share + censo_log_pop + censo_median_wage + mayor_campaign + mayor_coalition_size,
    data = .
  )

# print plots
multilevel_fit$coalition_full %>% 
  tidycoef +
  scale_y_discrete(
    labels = c(
      "Median wage",
      "Opposition share (squared)",
      "Size of mayor coalition",
      "Population size",
      "Campaign expenditures",
      "Opposition share"
    )
  ) +
  ggtitle("Hierarchical model: New hires \non opposition share")
```

## Conclusion:

This paper outlines initial findings with regards to coalitional dynamics in determining cabinet positions. I have constructed a game theoretical model that outlines the mechanism behind the decision-making process of the executive. Departing from previous literature on state capacity, I explicitly model the decision-making process of the executive to invest in state capacity. The intuition behind the model is that the executive (mayor) and the opposition face different incentives. The mayor gets reelected through good performance (in a probabilistic sense), while for the opposition legislator the primary goal is to receive patronage jobs from the executive.

The goal of this document is to expand on existing literature on public sector employment in the developing world. The lack of an explicit treatment of the institutional and political context of local governments, as well as the theoretical underpinnings of politicized administration limits our understanding of the strategic incentives faced by executive leaders when deciding whether or not to improve the quality of the administrative apparatus. Furthermore, patronage is costly, and my preliminary evidence suggests it is not clear that it unambiguously helps incumbents get reelected.

Part of the contribution in this analysis is arguing that it is not simply because in the developing world civil service laws are absent that executive leaders will dismantle bureaucracies completely. They will do so strategically, and the extent to which they do so depends to a large degree on the amount of control they exert over the legislative chamber and how strongly the opposition can exercise its veto power. If executive leaders lack the power to impose their preferences over the legislative, and in particular when faced with a strong opposition, they will be forced to concede more jobs in order to be able to implement their policy agenda in the first place.

It is paramount to move away from studies of bureaucracies that consider any form of interference by political leaders as detrimental to state capacity. Rather, it is necessary to understand the political game in which these actors are embedded and how reelection prospects, governance and the need for legislative cooptation shapes politicians' incentives to engage in patronage or improve the quality of local bureaucracies. This has deep implications on the quality of the public services provided to a population so desperately in need of high quality public goods.

<!--chapter:end:chapters//06-coalitional.Rmd-->

```{r include=FALSE, cache=FALSE}
rm(list = ls(all = T))
# set up ------------------------------------------------------------------
pacman::p_load(
  tidyverse,
  data.table,
  rgdal,
  here,
  R.utils,
  GGally,
  lfe,
  lme4,
  plm,
  broom,
  extrafont,
  rprojroot,
  tmap,
  gridExtra,
  cowplot,
  ggdag,
  scales,
  kableExtra,
  RColorBrewer,
  gghighlight,
  parallel,
  foreach,
  gridExtra,
  naniar,
  knitr
)

knitr::opts_chunk$set(
  eval = T,
  cache = T,
  cache.lazy = F,
  message = F,
  warning = F,
  echo = F,
  fig.height = 5,
  fig.width = 8,
  fig.align = "center"
  # dev = "png"
)

source("scripts/thesis_funs.R")

`%<>%` <- magrittr::`%<>%`
between <- data.table::between
set.seed(1789)
```
# Looking forward

<!--chapter:end:chapters//07-beyond-politics.Rmd-->

```{r include=FALSE, cache=FALSE}
rm(list = ls(all = T))
# set up ------------------------------------------------------------------
pacman::p_load(
  tidyverse,
  data.table,
  rgdal,
  here,
  R.utils,
  GGally,
  lfe,
  lme4,
  plm,
  broom,
  extrafont,
  rprojroot,
  tmap,
  gridExtra,
  cowplot,
  ggdag,
  scales,
  kableExtra,
  RColorBrewer,
  gghighlight,
  parallel,
  foreach,
  gridExtra,
  naniar,
  knitr
)

knitr::opts_chunk$set(
  eval = T,
  cache = T,
  cache.lazy = F,
  message = F,
  warning = F,
  echo = F,
  fig.height = 5,
  fig.width = 8,
  fig.align = "center"
  # dev = "png"
)

source("scripts/thesis_funs.R")

`%<>%` <- magrittr::`%<>%`
between <- data.table::between
set.seed(1789)
```
# Conclusion

<!--chapter:end:chapters//08-conclusion.Rmd-->

