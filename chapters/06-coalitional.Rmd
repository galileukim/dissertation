# Coalitional dynamics

```{r include = F}
# read in
cabinet <- fread(
    here("data/rais/rais_cabinet.csv.gz")
  ) %>%
  filter(
    year >= 2005
  ) %>% 
  mutate(
    state = as.factor(str_sub(cod_ibge_6, 1, 2))
  ) %>% 
  join_covariate()

# restrict data to mandate years
cabinet_fit <- cabinet %>%
  filter(
    year %in% seq(2005, 2013, 4)
  ) %>%
  mutate(
    coalition_share = (100 - coalition_share)
  ) %>% 
  mutate_if(
    is.double,
    scales::rescale
  )
  
# import municipal tables
cabinet_mun <- fread(
  here("data/rais/rais_cabinet_mun.csv")
  ) %>%
  filter(
    year >= 2005
  ) %>% 
  mutate(
    state = as.factor(str_sub(cod_ibge_6, 1, 2))
  ) %>% 
  add_election()
  
# restrict data to mandate years
cabinet_mun_fit <- cabinet_mun %>%
  filter(
    year %in% seq(2005, 2013, 4),
    cabinet_size/rais_mun_size <= 0.2
  ) %>% 
  join_covariate() %>% 
  mutate(
    coalition_share = (100 - coalition_share)
  ) %>% 
  group_by(cod_ibge_6) %>% 
  mutate(
    prop_higher_edu_lag = dplyr::lag(prop_higher_edu, order_by = year)
  ) %>% 
  ungroup() %>% 
  mutate_if(
    is.double,
    scales::rescale
  )

# rais data
rais <- gunzip(
  here("data/rais/rais.csv.gz"),
  temporary = T,
  overwrite = T,
  remove = F
) %>%
  fread() %>%
  filter(
    year >= 2005
  ) %>%
  mutate(
    state = as.factor(str_sub(cod_ibge_6, 1, 2))
  )

# municipal rais
rais_mun <- fread(
  here("data/rais/rais_mun.csv.gz")
) %>% 
  group_by(
    cbo_category
  ) %>% 
  mutate_at(
    vars(starts_with("mean")),
    ~weighted.mean(., na.rm = T, w = total)
  ) %>% 
  mutate_at(
    vars(total),
    sum,
    na.rm = T
  ) %>% 
  ungroup()

# restrict data to mandate years
rais_mun_fit <- rais_mun %>%
  filter(
    year %in% seq(2005, 2013, 4)
  ) %>%
  mutate_if(
    is.double,
    scales::rescale
  )

rais_mun_fit <- rais_mun_fit %>%
  join_covariate()

# import municipal tables
rais_cabinet_mun <- fread(
  here("data/rais/rais_cabinet_mun.csv")
) %>%
  filter(
    year >= 2005
  ) %>% 
  join_covariate()

election <- fread(
  here("data/tse/election.csv")
)

mayor <- fread(
  here("data/tse/mayor.csv")
)
```

## Coalitional presidentialism

In Brazil, the executive-legislative bargain has been the object of recurrent research. Since the seminal work of Abranche (1988), scholars have emphasized that the relationship between the president and the national legislature (*Congresso Nacional*) was characterized by coalitional presidentialism.^[@power_optimism_2010.] The term referred to the bargaining process between president and legislators, where governing presidents resorted to the concession of pork and cabinet positions in order to secure support by the legislature for their policy agenda. While there remains debate as to whether presidential coalitionism induces partisan or personalistic voting, there is little controversy that the exchange of administrative posts for legislative votes is widespread in federal politics.^[@figueiredo_presidential_2000, @raile_executive_2011.]

The need for coalitions stems principally from Brazil being characterized by a multipartisan, fragmented system.^[@mainwaring_rethinking_1999, @samuels_presidentialized_2002.] In the absence of a clear majority in the legislature and strong ideological commitments by parties, presidents have to build coalitions through the concession of valuable positions in their cabinet. Positions such as the Ministry of Transportation are particularly valuable since parties controlling it can target infrastructure investments to party members at the state or municipal level. These concessions, however, are costly. Policies over which the president seeks to retain control, such as the Ministry of Finance are generally protected from the political bargains embedded in presidential coalitionism.^[@batista_o_2013, @loureiro_politica_1999.]

This regularity raises the question of what factors help explain variation in the degree of autonomy and politicization of federal bureaucracies and administrative structures under political oversight more generally.^[See @bersch_state_2017.] Scholars have pointed out ideological differences between president and coalition party members, as well as the relative importance of a ministry portfolio to the president as relevant factors in explaining cabinet allocation.^[@batista_o_2013.] However, analysis based on presidential and congressional data faces sample size limitations that make it difficult to assess which presidential characteristics - and congressional ones - explain variation in the degree of instability in bureaucratic structures.

In order to explore these causal mechanisms further, I analyze local legislatures, mayors and bureaucratic positions in municipal Brazil. An analogous political structure, with a separation of power between the mayor and a local legislature occupied by a large number of parties, suggests that a similar coalitional dynamic could be at play. Moreover, in the absence of regulations preventing local politicians from allocating key cabinet positions to coopt legislators, there is good reason to suspect that a similar executive-legislative bargain could be shaping the allocation of public sector jobs in municipalities across Brazil. In the next section, I provide an outline of local government structures and the variation in a key explanatory variable: executive control over legislatures.

## The case: Brazilian municipalities and mayoral coalitionism

How applicable are these analytical building-blocks to the local level? Each and every municipality in Brazil institutionalizes separation of powers. Mayors do not govern alone: with every municipal election, an executive leader and her legislative counterparts take office. Recent studies on local governments in Brazil often overlook this institutional feature, disregarding the fact that municipalities comprise both an executive and legislative branch.^[Most studies analyzing Brazilian governments focus exclusively at mayors. See @brollo_victor_2017, @brollo_tying_2012, @colonnelli_patronage_2017, @klasnja_incumbency_2017.] While mayors have exclusive prerogative over the appointment of local employees and establishing a policy agenda, appointments respond to the need to ensure legislative support.^[Interview with C.F. and F. in SP.]

The municipal legislative chamber plays a central role in municipalities. It is responsible for oversight and vetoing the executive budget, as well as approving and ammending municipal laws. This grants the legislative chamber and its city councillors significant power over the mayor's ability to implement their policy agenda. In order to garner legislative support, it is common for mayors to concede key cabinet positions to city councillors.^[Interview with C.F. and F. in SP.] A set of scholars have started to analyze this tradeoff between legislative support and cabinet allocation at the federal level, but to the best of my knowledge the municipal level is yet to be explored.^[Batista et al. 2018]

While conducting fieldwork research in Brazil, I was struck by the recurrent accounts of the important role played by local city councillors (vereadores) in shaping the bureaucracy. Secretaries of education argue that deputees often demanded to nominate their own loyalists to prominent cabinet positions, with the tacit but careful approval of the mayor.^[Interview with F, chief of staff of a local government in SP.] The degree to which mayors acquiesced to these demands depends on their bargaining power: how many seats their coalition was able to secure in the local chamber. When the executive coalition held a comfortable margin, the need to appease coalition members through appointments was less pressing.^[Similar to the findings of @neto_presidential_2006.] Conversely, budgetary resources can be withheld when mayors are in a minority governemnt.

```{r budget}
rais_cabinet_mun %>% 
  ggplot(
    aes(
      coalition_share,
      budget_total/censo_pop
    )
  ) +
  geom_smooth(
    formula = y ~ splines::bs(x, 3),
    method = "lm",
    col = "steelblue"
  ) +
  stat_summary(
    fun.y = "mean",
    geom = "point",
    col = "coral3",
    alpha = 0.5
  ) +
  theme_clean +
  xlab("Coalition Share") +
  ylab("Budget per Capita") +
  ggtitle("Budget per capita vs. share of legislative seats held\n by the executive coalition")
```

While most mayors tend to hold a majority of seats over the chamber, this is far from being the rule. Note that I am adopting an expansive view of chamber control: if the deputee's party is in the executive electoral coalition that is registered prior to the electoral campaign, I count that seat as being part of the mayoral coalition share. This is similar to the operationalization of presidential control over the congress in presidential coalitionism and based on interviews with municipal secretaries.^[Pereira et al. 2016, Figueiredo and Limongi 2012, Raile et al. 2011.] I exploit this variation, both intermunicipal and across time, in executive coalition shares to explain decisions over bureaucratic turnover.

```{r cabinet coalition share}
election %>%
  ggplot() +
  geom_histogram(
    aes(
      x = coalition_share*100
    ),
    geom = "line",
    col = "cadetblue3",
    fill = "steelblue3",
    alpha = 0.8
  ) +
  geom_vline(
    xintercept = 50, 
    linetype = "dashed",
    col = "darkred"
  ) +
  theme(
    legend.position = "bottom",
    legend.title = element_blank(),
    legend.spacing.x = unit(0.05, "inch")
  ) +
  theme_clean +
  xlab("Coalition Share") +
  ylab("Density") +
  ggtitle("Mayor coalition seat share")
```

Why focus on local bureaucracies? While extant literature on state capacity generally focus analysis on federal bureaucracies, in the past two decades Brazil, along with other Latin American countries, have embarked on ambitious decentralization efforts.^[@falleti_decentralization_2010.] As a result of this efforts, not only public policy implementation, but the number of bureaucratic staff under municipal responsibility has increased rapidly. This growing staff, along with the political principals responsible for hiring them, are only beginning to be empirically explored.^[@colonnelli_patronage_2017, @brollo_victor_2017.] Much remains to be done.

```{r rais time}
rais_mun %>% 
  filter(
    year >= 2003
  ) %>% 
  mutate(
    rais_size = total*4/1e3,
    cbo_category = str_to_title(cbo_category)
  ) %>% 
  group_by(
    cbo_category,
    year
  ) %>% 
  summarise(
    rais_size = sum(rais_size)
  ) %>% 
  ggplot(
    aes(
      x = as.factor(year),
      y = rais_size,
      group = cbo_category
    )
  ) +
  geom_line(
    col = "cadetblue3"
  ) +
  geom_point(
    col = "steelblue3"
  ) +
  xlab("Year") +
  ylab("Number of staff (thousands)") +
  facet_wrap(
    ~ cbo_category,
    ncol = 2,
    scales = "free_y"
  ) +
  scale_x_discrete(
    breaks = seq(2003, 2015, 3)
  ) +
  theme_clean +
  ggtitle(
    "Growth in municipal bureaucracies (by category)"
  )
```


In the next section, I outline the executive's dilemma. I model this in game theoretical terms to embed the bureaucracy in the political game to which it is subjected. Combining insights from the literature on presidential coalitionism, electoral accountability and patronage, I theorize that newly elected mayors face a straightforward sequential optimization problem: the quality of public goods provision is directly observed by the electorate and depends on keeping patronage at a minimum. At the same time, patronage is necessary to buy-off legislative support. The ambition for reelection and the need to coopt the legislative in the current period defines the terms of the politics of patronage. For the full, formal treatment, refer to the appendix.

## The Executive Dilemma:

I build a theoretical framework to explain variation in bureaucratic turnover. A new mayor is elected into office and has the power to reshape the local bureaucracy. To be reelected, she has to convince the electorate that she will provide high quality public goods in her second term, and to do so requires bureaucratic coherence. However, she must also coopt the legislative opposition by divving up a share of the bureaucratic pie for patronage.^[This aligns closely to previous studies on the use of ministerial positions to gain support from opposition members at the federal level. See @loureiro_politica_1999, @loureiro_radiografia_2014, @lopez_cargos_2018.] The model highlights the tradeoff executive politicians face between investing in state capacity and coopting the legislative opposition.

Accomodating a shifting legislative political arena requires introducing new members into the local public machine. Bureaucratic turnover in this model stems from decisions by the executive to distribute jobs for political purposes. This is a particular manifestation of patronage, the allocation of public sector jobs to garner political support.^[@brollo_victor_2017.] Certainly, bureaucratic turnover can take a variety of forms, and my empirical strategy accomodates for its multivariate structure. In the estimation, two outcomes of interest are analyzed: proportion of newly hired cabinet members and proportion of personnel fired.

The theoretical model builds on an extensive literature in the electoral accountability literature, modeling public goods provision as an electoral game played between the voter and the politician. Starting with @barro_control_1973 and @ferejohn_incumbent_1986, political economists have explored models incorporating electoral accountability as an incentive for shaping the behavior of elected politicians.^[See, for instance, @ferraz_electoral_2011.] The possibility of reelection motivates them to put effort into convincing voters to reelect them. @coate_form_1995 and @besley_principled_2006 incorporate voters updating Bayesian beliefs about politician types, a feature applied in my model.

I extend these analyses with a key feature. Instead of assuming that politicians can set the quality of public goods provision, I model it as the probabilistic outcome of an investment in bureaucratic quality and legislative support. Producing better public goods requires an experienced and professional bureaucracy and legislative support. Reshuffling the bureaucracy is costly due to the loss of professional expertise accumulated by the inherited staff, but this underlying capacity is meaningless if the legislative does not grant its approval. The executive does not always control the legislative chamber once in office, and have to coopt them into supporting their agenda.^[Analogous to the concept of minority presidents in the literature on coalitional presidentialism. See @figueiredo_presidential_2000.]

The mayor's strategy centers around a key part of her political resources: the local bureaucracy. A set of public sector jobs is available to the executive for redistribution. Jobs are a valuable resource for cooptation.^[Mayors enjoy full discretion into how to appoint workers into the public sector and often resort to distributing these jobs to appease members of the legislative.] When deciding whether or not to engage in patronage, executive leaders face a dilemma. The mayor can invest in state capacity, retaining expertise and reaping benefits from better public goods provision and retaining office. However, doing so raises the possibility of retaliation by the opposition, who can threaten to bar the provision of public services. This is the executive's dilemma.^[@geddes_politicians_1994.]

## Cabinet share:

Cabinet members are responsible for administering the local executive branches. This includes key functions such as education, health, transportation, among others. The structure of cabinets vary according to the complexity of municipal administrations, often correlated with the population size of the municipality. These are positions of trust (\textit{cargos de confiança}), and the mayor has full discretion in appointing and firing these cabinet members. Consistent with the theoretical model outlined above, I find that reshuffling in cabinet positions is often done with restraint, with a significant share of cabinet members being transferred from previous administrations.

Extant literature on nomination of local cabinets is limited. Apart from anecdotal evidence on nomination practices, scholars in Brazil have not analyzed extensively how municipal cabinet positions are filled.^[Interview with Glauco Peres da Silva, professor at Universidade de São Paulo.] We know little to nothing of what proportion of these bureaucrats are being hired strictly through political nomination, and how the political calculus behind their nomination takes place. In local governments with no obligation to respect civil service laws, one would expect to observe politicians appoint loyalists and eradicate those left over from the previous administration.^[Brollo et al. 2018, Lewis 2008, Lopez et al. 2015.] There are, however, costs to cabinet reshuffling: an inexperienced cabinet member will have a difficult time governing.

Leveraging a unique dataset of local bureaucrats in Brazil, I find that cabinet reshuffling is circumscribed to a fraction of the available positions. Only a small subset of the cabinet is renewed with each mandate. I shed light on temporal dynamics, looking at the proportion of newly hired cabinet positions annually. The proportion of cabinet members who are appointed for their first time is small. There are spikes in cabinet hiring in the first year of mandate, yet this is limited to around a third of available seats. This means that around two thirds of the upper echelon of the local bureaucracies is retained from the previous administration.

```{r new-hires}
# share of new hires
cabinet %>%
  group_by(
    year
  ) %>%
  summarise_prop(
    "rais_hired"
  ) %>% 
  ggplot(
    aes(
      year,
      prop
    )
  ) +
  geom_point(
    col = "cadetblue3"
  ) +
  geom_linerange(
    aes(
      ymax = upper,
      ymin = lower
    ),
    col = "cadetblue3"
  ) +
  scale_x_continuous(
    breaks = seq(2005, 2013, 4)
  ) +
  mandate_year() +
  theme_clean +
  ggtitle("Proportion of newly-hired cabinet members")

# # share of fires
# cabinet %>%
#   group_by(
#     year
#   ) %>%
#   summarise_mun(
#     "rais_fired"
#   ) %>% 
#   ggplot(
#     aes(
#       year,
#       prop
#     )
#   ) +
#   geom_point(
#     col = "cadetblue3"
#   ) +
#   geom_linerange(
#     aes(
#       ymax = upper,
#       ymin = lower
#     ),
#     col = "cadetblue3"
#   ) +
#   scale_x_continuous(
#     breaks = seq(2005, 2013, 4)
#   ) +
#   mandate_year +
#   theme_clean +
#   ggtitle("Proportion of newly-hired cabinet members")
```

The fact that mayors are reelected affects the amount of cabinet turnover observed. Breaking down our data into first-term and reelected mayors, there are clear differences between the two. Mayors elected for the first time tend to hire far more new cabinet members than those who are reelected. Even then, on average only around 35 percent of cabinet positions are renewed with first-term mayors. I now break down hiring of cabinet members by whether or not there is a party or coalition turnover. Intuitively, if it is the same party that remains in power or if members of the coalition accede to executive power. Let's check if that is the case, first analyzing party switches. I exclude from sample mayors who are reelected, where party continuity is trivial. Individual candidates may not run for office again as a lameduck, but their party can field another candidate.

```{r party turnover}
# new hires
cabinet %>%
  filter(
    !is.na(party_turnover)
  ) %>%
  group_by(
    year,
    party_turnover
  ) %>%
  summarise_mun(
    "rais_hired"
  ) %>%
  mutate(
    party_turnover = if_else(
      party_turnover == 1,
      "party turnover", "no turnover"
    )
  ) %>% 
  ggplot(
    aes(
      year,
      prop
    )
  ) +
  geom_point(
    aes(
      col = as.factor(party_turnover)
    )
  ) +
  geom_linerange(
    aes(
      ymax = upper,
      ymin = lower,
      col = factor(party_turnover)
    )
  ) +
  scale_color_manual(
    breaks = c("party turnover", "no turnover"),
    values = c("cadetblue3", "coral3")
  ) +
  scale_x_continuous(breaks = seq(2005, 2015, 2)) +
  mandate_year() +
  theme_clean +
  theme(
    legend.position = c(0.925, 0.95),
    legend.title = element_blank()
  ) +
  ggtitle("Proportion of new hires: party turnover")

# career bureaucrats
cabinet %>%
  mutate(
    party_turnover = if_else(
      mayor_party != mayor_party_lag &
      mayor_reelected != 1,
      1, 0
    )
  ) %>%
  filter(
    !is.na(party_turnover)
  ) %>%
  group_by(
    year,
    party_turnover
  ) %>%
  summarise_mun(
    "rais_permanent"
  ) %>%
  mutate(
    party_turnover = if_else(
      party_turnover == 1,
      "party turnover", "no turnover"
    )
  ) %>% 
  ggplot(
    aes(
      year,
      prop
    )
  ) +
  geom_point(
    aes(
      col = as.factor(party_turnover)
    )
  ) +
  geom_linerange(
    aes(
      ymax = upper,
      ymin = lower,
      col = factor(party_turnover)
    )
  ) +
  scale_color_manual(
    breaks = c("party turnover", "no turnover"),
    values = c("cadetblue3", "coral3")
  ) +
  scale_x_continuous(breaks = seq(2005, 2015, 2)) +
  mandate_year() +
  theme_clean +
  theme(
    legend.position = c(0.925, 0.95),
    legend.title = element_blank()
  ) +
  ggtitle("Proportion of career bureaucrats: party turnover")
```

Remarkably, we find that even when the mayor is **not** reelected, if the same party remains in power, there is significantly less rotation at the top level. This is an interesting finding, that sheds doubt on standard accounts of the weakness of Brazilian parties in constraining executive behavior by individual members.^[@klasnja_incumbency_2017.] Additionally, the proportion of career bureaucrats in the case of party continuity increases when the same party remains in power. These factors will be taken into account when we estimate the impact of the share of seats held by the legislative opposition.

<!-- ## Career bureaucrats: -->

<!-- Let's look at the proportion of cabinet members who are permanent employees. These are career servants in the municipal bureaucracy, who have risen up the ranks and are appointed to cabinet positions. Contrary to what I expected, there is a large proportion of such cabinet members. The graph below illustrates the turnover (proportion of new hires) across each subgroup: temporary and career servants. Far more cabinet members are replaced when offered a temporary contract, as would be expected. -->

<!-- ```{r permanent} -->
<!-- # share of permanent cabinet positions -->
<!-- cabinet %>% -->
<!--   group_by( -->
<!--     year -->
<!--   ) %>% -->
<!--   summarise_mun( -->
<!--     "rais_permanent" -->
<!--   ) %>% -->
<!--   rename( -->
<!--     prop_permanent = prop -->
<!--   ) %>% -->
<!--   ggplot( -->
<!--     aes( -->
<!--       year, -->
<!--       prop_permanent -->
<!--     ) -->
<!--   ) + -->
<!--   geom_point( -->
<!--     col = "cadetblue3" -->
<!--   ) + -->
<!--   geom_linerange( -->
<!--     aes( -->
<!--       ymax = upper, -->
<!--       ymin = lower -->
<!--     ), -->
<!--     col = "cadetblue3" -->
<!--   ) + -->
<!--   scale_x_continuous( -->
<!--     breaks = seq(2005, 2015, 2) -->
<!--   ) + -->
<!--   mandate_year + -->
<!--   theme_clean + -->
<!--   ggtitle("Share of career bureaucrats in cabinet") -->
<!-- ``` -->

<!-- Growing use of career offers in contracts. Ranging from 44% in 2005 to roughly 46% in 2015. Now, I wonder why is it the case that some of these secretaries actually remain with permanent linkages to the local bureaucracy. Is it the case that mayors with stronger control of the legislative hire more career servants? This may very well be the case of the vertical up and down that the coordinators of the PAIC in Quixelô had mentioned to me. This would be fascinating, because in this case we would actually see an internal appointment of secretaries. -->

## Verifying assumptions: reelection in the face of patronage

A working assumption in the literature on clientelism is that patronage pays off: politicians reap electoral benefits from distributing jobs for their followers.^[@brollo_victor_2017, @calvo_who_2004.] For example, @folke_patronage_2011 find that states where civil service laws were not enacted, the party was more likely to remain in power than their professionalized counterparts. The challenge, empirically, is that previous studies rarely assess whether engaging in patronage actually helps incumbents remain in office. I provide an initial step towards this direction. In Brazilian municipalities, it is fairly common for incumbent mayors to run for office. Does engaging in patronage during the first period helps her be reelected into office? Preliminary evidence seems to suggest no.

```{r reelection}
mayor_reelection <- mayor %>% 
  filter(
    election_year >= 2004 & election_year < 2016
  ) %>% 
  left_join(
    rais_cabinet_mun %>% 
      filter(
        year %in% seq(2005, 2013, 4)
      ) %>% 
      transmute(
        cod_ibge_6,
        election_year = election_year + 4,
        mean_hired,
        mean_fired,
        rais_permanent,
        cabinet_size
      ),
    by = c("cod_ibge_6", "election_year")
  ) %>% 
  left_join(
    fread(
      here("data/censo_br/censo_2000.csv")
    ),
    by = c("cod_ibge_6")
  )

# filter incumbents
mayor_reelection <- mayor_reelection %>% 
  filter(
    incumbent == 1
  )

# probability of winning
mayor_reelection %>% 
  group_by(
    mean_hired
  ) %>% 
  summarise(
    elected_prob = mean(elected)
  ) %>% 
  ggplot() +
  geom_smooth(
    aes(mean_hired, elected_prob),
    method = "lm"
  ) +
  theme_clean +
  xlab(
    "Proportion of new hires"
  ) +
  ylab(
    "Probability"
  ) +
  ggtitle(
    "Probability of reelection vs. proportion of new hires"
  )

# logistic
fit_reelection <- list()

fit_reelection <- fit_logit(
  repo = fit_reelection,
  "elected",
  predictor = c("mean_hired"),
  control = c("rais_permanent", "cabinet_size", "gender", "as.factor(party)", "edu", "censo_median_wage", "censo_log_pop"),
  data = mayor_reelection
)

fit_reelection$logit_full %>% 
  tidycoef + 
  scale_y_discrete(
    labels = rev(
      c(
        "Mayor education",
        "Career servants",
        "Municipal median wage",
        "New hires",
        "Population size (logged)",
        "Firing",
        "Gender"
      )
    )
  ) +
  ggtitle("Logit: Probability of reelection vs patronage")
```

The evidence for electoral benefits from engaging in patronage is not clear. In fact, it seems that gender - unsurprisingly - and the education level of the mayor are better predictors of whether or not an incumbent is reelected than indicators for potential patronage: the proportion of newly hired bureaucrats, dismissal rates and career servants in the bureaucracy. These seem to be counterproductive for reelection prospects: an increase in firing and hiring tend to be negatively correlated with reelection, while increases in career servants help While I leave the analysis limited at this point, there is far more to explore with regard to the decision-making process of the electorate in whether or not to retain an incumbent.

## Empirical testing:

The main implication of my theoretical model is that the share of seats held by the legislative opposition will have a negative effect on state capacity. In terms of observable implications, we should see that in municipalities where the mayor faces a strong legislative opposition, she will resort to greater patronage, with more hiring into and less permanent bureaucrats in cabinet positions. Descriptively, we find an inverse, quadratic relationship between the size of the opposition and the proportion of newly hired cabinet members.

```{r visual}
cabinet %>%
  group_by(
    coalition_margin + 0.5
  ) %>%
  mutate(
    prop_hired = mean(rais_hired, na.rm = T)
  ) %>% 
  ggplot(
    aes(
      coalition_margin,
      prop_hired
    )
  ) +
  geom_count(
    alpha = 0.4,
    col = "coral3"
  ) +
  geom_vline(
    xintercept = 0,
    linetype = "dashed"
  ) +
  geom_smooth(
    method = "lm",
    formula = y ~ splines::bs(x, 3),
    col = "cadetblue3"
    # data = . %>% filter(coalition_margin < 95)
  ) +
  coord_cartesian(
    ylim = c(0, 0.35),
    xlim = c(-0.5, 0.5)
  ) +
  xlab("Opposition share") +
  ylab("Proportion of new hires") +
  theme_clean
```

I first naively estimate the relationship between share of opposition legislative seats and the use of patronage, leveraging micro-level bureaucratic data. I regress the bureaucratic turnover (for an individual $Y_{ijt}$ or a municipal proportion $\bar{y_{jt}}$) on the share of legislative seats held by the mayoral opposition. There are two outcomes of interest: new-hires and firing of cabinet members. To account for possible non-linearity, I introduce a quadratic term for opposition share of seats.^[The results are not changed by this inclusion.] I include a set of controls $X_{jt}$, with demographic covariates, bureaucrat's characteristics, political-institutional variables and mayor-level characteristics.^[These include, among others, the size of the municipality, type of bureaucratic contract (permanent or not) mayor partisanship, education level of legislators, effective number of parties and municipal median wage, which I use as a proxy for economic development.] Standard errors are clustered at the year and municipal level for the fixed effects specification. For the micro-level logistic specification, we have:

$$Y_{ijt} = \alpha_j + \delta_t + \beta\times\text{Opposition share}_{jt} + \beta\times\text{Opposition share}^2_{jt} \gamma X_{jt} + \epsilon_{ijt}$$
For the fixed effects regression, the model regresses the proportion of bureaucrats possessing a particular characteristic (e.g. newly-hired) on a similar set of predictors to the specification above. For simplicity, I preserve a similar notation.

$$\bar{y}_{jt} = \alpha_j + \delta_t + \beta\times\text{Opposition share}_{jt} + \gamma X_{jt} + \epsilon_{jt}$$

The estimate of innerest is $\beta$, the effect of opposition share on bureaucratic turnover. In the absence of a credible identification strategy, these estimates are not plausibly causal. However, the sum of these results, albeit confounded, point to a similar substantive result: the proportion of seats controlled by the opposition is positively associated with bureaucratic turnover.
 
The results below are from a logistic regression. This is a simple exercise, but since the level of observation is the individual hiring and there is a clearly hierarchical structure, multi-level modelling seems to be the natural next step to take. I do so below when running the robustness checks.

```{r hiring micro}
fit_hired <- list()

# fit_hired <- glmer(
#   rais_hired ~ (1|year/cod_ibge_6) + coalition_share + 
#     mayor_party + mayor_coalition_size + mayor_reelected +
#     censo_log_pop + censo_median_wage,
#   data = cabinet_fit,
#   family = binomial
# )s

# logit model
fit_hired <- fit_logit(
  fit_hired,
  "rais_hired",
  predictor = "coalition_share + I(coalition_share^2)",
  data = cabinet_fit
)

# print plot
fit_hired$logit_full %>%
  tidycoef + 
  scale_y_discrete(
    labels = c("Opposition share (squared)", "Wage (bureaucrat)", "Median wage", "Mayor reelected", "Career servant", "Education level (bureaucrat)", "Campaign expenditures", "Number of parties in coalition", "Municipal pop. size (logged)", "Opposition share")
  ) +
  ggtitle("Logit: New cabinet hire on\n opposition share of seats")
```

These results point to the importance of executive-legislative relations in the appointment of executive positions. Clearly, campaign contributions also matter and may indicate the occurrence of prebendism in Brazil.^[I explore these patterns in another paper.] Complementing longstanding debates on the relevance of poverty to shape politicians' distribution of patronage, these models point out that local executives behave in accordance with control of the chamber. The coefficient for the share of oppositions seats in the legislative chamber is positive and significant: the more seats the executive controls, the greater the likelihood of a new hire into the cabinet.

These new hires actually can be interpreted as a form of executive "cooptation", but as it stands it is only a suggestive result. Interviews with current and former secretaries confirm that the forging of alliances at the chamber level is conditional on the concession of cabinet positions or, more often, at the directorate level. I now proceed to test a fixed effects model, with the municipality as the unit of analysis.

```{r hiring municipal}
fit_hired_mun <- list()

# clustered ols
fit_hired_mun <- fit_felm(
  fit_hired_mun,
  "mean_hired",
  predictor = c("coalition_share + I(coalition_share^2) + mayor_reelected + prop_higher_edu_lag"),
  data = cabinet_mun_fit
)

# print plot
fit_hired_mun$ols_full %>%
  tidycoef +
  scale_y_discrete(
    labels = c(
        "Opposition share (squared)",
        "Mayor reelected",
        "Median wage (bureaucracy)",
        "Proportion of career servants",
        "Education level of bureaucracy",
        "Effective parties",  
        "Size of bureaucracy", 
        "Mayor age", 
        "Previous cabinet edu",
        "Size of mayor coalition",
        "Opposition share",
        "Campaign expenditures"
      )
  ) +
  ggtitle(
    "FE: Proportion of new cabinet hire on\n opposition share of seats"
  )
```

The results are robust to the above specifications. There is consistent evidence that the share of opposition seats is positively related to hiring of cabinet members. Having documented the importance of legislative opposition in the hiring of cabinet members, I now analyze how firing of cabinet members varies as a result of changes in opposition share.

```{r firing}
# micro-level
fit_fired <- list()

# logistic
fit_fired <- fit_logit(
  fit_fired,
  "rais_fired",
  data = cabinet_fit
)

# print plot
fit_fired$logit_full %>%
  tidycoef +
  scale_y_discrete(
    labels = c(
      "Campaign expenditures",
      "Career servant",
      "Median wage",
      "Mayor reelected",
      "Education level (bureaucrat)",
      "Size of mayor coalition", 
      "Opposition share",
      "Population size", 
      "Wage (bureaucrat)"
    )
    ) + 
  ggtitle("Logit: Fired cabinet members on\n opposition share of seats")

# mun-level
fit_fired_mun <- list()

fit_fired_mun <- fit_felm(
  fit_fired_mun,
  "mean_fired",
  predictor = c("coalition_share + I(coalition_share^2) + mayor_reelected + prop_higher_edu_lag"),
  data = cabinet_mun_fit 
)

# print plot
fit_fired_mun$ols_full %>%
  tidycoef +
  scale_y_discrete(
    labels = rev(
      c(
        "Opposition share",
        "Effective parties",
        "Previous cabinet edu",
        "Education level (bureaucrat)",
        "Mayor reelected",
        "Size of mayor coalition",
        "Mayor age", 
        "Size of bureaucracy",
        "Opposition share (squared)",
        "Proportion of career servants",
        "Median wage (bureaucracy)", 
        "Campaign expenditures"
      )
    )
  ) +
  ggtitle("FE: Proportion of cabinet fired on\n opposition share of seats")
```

There is supporting evidence that firing rates change as a result of the presence of strong legislative opposition in the chamber. Including the full set of control variables indicates that firing rates increases significantly as the opposition takes control of the legislative chamber.

## Robustness checks:

In this section, I take into account the hierarchical structure of bureaucratic turnover. I run a multi-level model with political covariates at the second level, while letting the outcome of interest (bureaucratic turnover) vary at the first level. I find a similar effect for the hierarchical model specification. This adds confidence to the robustness of our results. Of course, there is far more to be done. In particular, the problem of endogeneity is never fully addressed. I am now working on identifying an exogenous shock to coalition structures to causally estimate the effect of changes in coalition share on patronage.

```{r}
# fit multilevel
multilevel_fit <- list()

# multilevel full
multilevel_fit[["coalition_full"]] <- cabinet_fit  %>%
  mutate(
    rais_hired*100
  ) %>% 
  lmer(
    rais_hired ~ (1|year) + (1|state) + I(coalition_share^2) + coalition_share + censo_log_pop + censo_median_wage + mayor_campaign + mayor_coalition_size,
    data = .
  )

# print plots
multilevel_fit$coalition_full %>% 
  tidycoef +
  scale_y_discrete(
    labels = c(
      "Median wage",
      "Opposition share (squared)",
      "Size of mayor coalition",
      "Population size",
      "Campaign expenditures",
      "Opposition share"
    )
  ) +
  ggtitle("Hierarchical model: New hires \non opposition share")
```

## Conclusion:

This paper outlines initial findings with regards to coalitional dynamics in determining cabinet positions. I have constructed a game theoretical model that outlines the mechanism behind the decision-making process of the executive. Departing from previous literature on state capacity, I explicitly model the decision-making process of the executive to invest in state capacity. The intuition behind the model is that the executive (mayor) and the opposition face different incentives. The mayor gets reelected through good performance (in a probabilistic sense), while for the opposition legislator the primary goal is to receive patronage jobs from the executive.

The goal of this document is to expand on existing literature on public sector employment in the developing world. The lack of an explicit treatment of the institutional and political context of local governments, as well as the theoretical underpinnings of politicized administration limits our understanding of the strategic incentives faced by executive leaders when deciding whether or not to improve the quality of the administrative apparatus. Furthermore, patronage is costly, and my preliminary evidence suggests it is not clear that it unambiguously helps incumbents get reelected.

Part of the contribution in this analysis is arguing that it is not simply because in the developing world civil service laws are absent that executive leaders will dismantle bureaucracies completely. They will do so strategically, and the extent to which they do so depends to a large degree on the amount of control they exert over the legislative chamber and how strongly the opposition can exercise its veto power. If executive leaders lack the power to impose their preferences over the legislative, and in particular when faced with a strong opposition, they will be forced to concede more jobs in order to be able to implement their policy agenda in the first place.

It is paramount to move away from studies of bureaucracies that consider any form of interference by political leaders as detrimental to state capacity. Rather, it is necessary to understand the political game in which these actors are embedded and how reelection prospects, governance and the need for legislative cooptation shapes politicians' incentives to engage in patronage or improve the quality of local bureaucracies. This has deep implications on the quality of the public services provided to a population so desperately in need of high quality public goods.
